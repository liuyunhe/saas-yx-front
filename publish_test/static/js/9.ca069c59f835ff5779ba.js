webpackJsonp([9],{"/fde":function(e,t){},"1AdJ":function(e,t){},"1Z9c":function(e,t){},"3ZC7":function(e,t){},"7BTO":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:()=>({load:!0,taskList:[],dialogVisible:!1,dialogTitle:"",form:{}}),created(){this.getTaskList()},methods:{getTaskList(){this.load=!0,this.$request.post("/api/wiseqr/mber/listBasic",{type:1},!0,e=>{if("200000"===e.ret)return this.taskList=e.data,void(this.load=!1);this.$message.error(e.message)})},openOrClose(e){e.row.status?this.switchAPI(e.row.status,e.row.id):this.$confirm("关闭后消费者将不能享受当前的级别的权益，未避免投诉，请谨慎操作。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.switchAPI(e.row.status,e.row.id)}).catch(()=>{this.$set(this.taskList[e.$index],"status",1),this.$message({type:"info",message:"已取消关闭"})})},switchAPI(e,t){this.$request.post("/api/wiseqr/mber/upTaskStatus",{status:e,id:t},!0,t=>{"200000"===t.ret?this.$message.success(e?"开启成功":"关闭成功"):this.$message.error(t.message)})},detail(e){this.$router.push(`/customer/task/detail?id=${e}`)},edit(e){"MEMBER_SCAN"!=e.taskCode?this.$request.post("/api/wiseqr/mber/detTaskById",{id:e.id},!0,t=>{if("200000"===t.ret)return this.form=t.data,this.dialogTitle=e.taskName,void(this.dialogVisible=!0);this.$message.error(t.message)}):this.$router.push(`/customer/task/scanEdit?id=${e.id}`)},saveTask(){if(!this.form.mbTask.score||!this.form.mbTask.growth)return this.$message.error("请完善表单数据!");this.$request.post("/api/wiseqr/mber/saveBasic",this.form,!0,e=>{if("200000"===e.ret)return this.$message.success("保存成功"),this.dialogVisible=!1,void this.getTaskList();this.$message.error(e.message)})}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],staticClass:"mt20",staticStyle:{width:"100%"},attrs:{border:"",data:e.taskList}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"taskName",label:"任务名称",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{prop:"score",label:"获得积分数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s("MEMBER_SCAN"!=t.row.taskCode?t.row.score:"/")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"growth",label:"获得成长值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s("MEMBER_SCAN"!=t.row.taskCode?t.row.growth:"/")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"更新时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.utime?new Date(t.row.utime).Format("yyyy-MM-dd hh:mm:ss"):"")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(s){return e.openOrClose(t)}},model:{value:t.row.status,callback:function(s){e.$set(t.row,"status",s)},expression:"scope.row.status"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.edit(t.row)}}},[e._v("编辑")])]}}])})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.form.mbTask?s("div",{staticClass:"score"},[s("span",[e._v("首次"+e._s(e.dialogTitle)+", 可获得")]),e._v(" "),s("el-input-number",{attrs:{controls:!1,min:0,max:1e6,precision:0},model:{value:e.form.mbTask.score,callback:function(t){e.$set(e.form.mbTask,"score",t)},expression:"form.mbTask.score"}}),e._v(" 积分\n    ")],1):e._e(),e._v(" "),e.form.mbTask?s("div",{staticClass:"growth"},[s("el-input-number",{attrs:{controls:!1,min:0,max:1e6,precision:0},model:{value:e.form.mbTask.growth,callback:function(t){e.$set(e.form.mbTask,"growth",t)},expression:"form.mbTask.growth"}}),e._v(" 成长值\n    ")],1):e._e(),e._v(" "),s("div",{staticClass:"btn mt20"},[s("el-button",{attrs:{type:"primary"},on:{click:e.saveTask}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{palin:""},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)])],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("3ZC7")},"data-v-037e004f",null);t.default=i.exports},"8cTO":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:()=>({total:100,load:!0,queryParams:{mobile:"",nickName:"",gradeNumber:"",pageNo:1,pageSize:10,ban:1},userDetailImgUrl:"http://qrmkt.oss-cn-beijing.aliyuncs.com/common/user-detail-img.png",rules:{nickName:[{max:32,message:"用户昵称长度不能超过 32 位",trigger:"blur"}],mobile:[{max:11,message:"手机号长度为11位",trigger:"blur"}],gradeNumber:[{min:1,max:3,message:"用户等级应为 1 到 3 位",trigger:"blur"}]},userList:[]}),mounted(){this.getUserList()},methods:{getUserList(){this.$refs.queryRef.validate(e=>{if(!e)return this.$message.error("请完善手机号!");this.$request.post("/api/wiseqr/mber/listUser",this.queryParams,!0,e=>{if("200000"===e.ret)return this.load=!1,this.userList=e.data.list,void(this.total=e.data.page.count);this.$message.error(e.message)})})},shift(e){this.$confirm("是否将该用户移出黑名单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$request.post("/api/wiseqr/mber/upUserBan",{id:e,ban:0},!0,e=>{if("200000"===e.ret)return this.$message.success("移出黑名单成功"),void this.getUserList();this.$message.error(e.message)})}).catch(()=>{this.$message({type:"info",message:"已取消"})})},isNum(e){isNaN(e)&&(this.queryParams.gradeNumber="")},reset(){this.queryParams.pageNo=1,this.$refs.queryRef.resetFields(),this.getUserList()},handleCurrentChange(e){this.queryParams.pageNo=e,this.getUserList()}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("el-card",{staticClass:"mb20"},[s("el-form",{ref:"queryRef",attrs:{model:e.queryParams,inline:"",rules:e.rules}},[s("el-form-item",{attrs:{label:"昵称：",prop:"nickName"}},[s("el-input",{model:{value:e.queryParams.nickName,callback:function(t){e.$set(e.queryParams,"nickName",t)},expression:"queryParams.nickName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"手机号：",prop:"mobile"}},[s("el-input",{model:{value:e.queryParams.mobile,callback:function(t){e.$set(e.queryParams,"mobile",t)},expression:"queryParams.mobile"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"用户等级：",prop:"gradeNumber"}},[s("el-input",{on:{change:e.isNum},model:{value:e.queryParams.gradeNumber,callback:function(t){e.$set(e.queryParams,"gradeNumber",t)},expression:"queryParams.gradeNumber"}})],1)],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.getUserList}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{plain:""},on:{click:e.reset}},[e._v("重置")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],attrs:{data:e.userList,border:""}},[s("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"头像",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("img",{attrs:{src:t.row.headimg||e.userDetailImgUrl,width:"40px",height:"40"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用户昵称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:t.row.scribeStatus?"red":""},[e._v(e._s(t.row.nickname))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"手机号",prop:"mobile",align:"center",width:"120px"}}),e._v(" "),s("el-table-column",{attrs:{label:"性别",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s("1"==t.row.gender?"男":"女")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"等级",prop:"gradeNumber",align:"center",width:"60px"}}),e._v(" "),s("el-table-column",{attrs:{label:"积分",prop:"points",align:"center",width:"100px"}}),e._v(" "),s("el-table-column",{attrs:{label:"成长值",prop:"growth",align:"center",width:"100px"}}),e._v(" "),s("el-table-column",{attrs:{label:"地区",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.province)+e._s(t.row.city)+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"注册时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.scribeTime?new Date(t.row.scribeTime).Format("yyyy-MM-dd hh:mm:ss"):"")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.$router.push("/customer/mgr/detail?id="+t.row.id)}}},[e._v("查看详情")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.shift(t.row.id)}}},[e._v("移出黑名单")])]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"mt20",attrs:{background:"","current-page":e.queryParams.pageNo,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("I5Wa")},"data-v-4f044b1a",null);t.default=i.exports},"99ZA":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:()=>({defaultList:[{name:"普通用户"}],rigthsList:[],listLen:0,openGradeList:[]}),created(){},mounted(){const e=this.$loading({target:".el-card"});this.getRightsList(()=>e.close())},methods:{getRightsList(e){this.$request.post(`/api/wiseqr/mbgrade/lists?_=${(new Date).getTime()}`,{},!0,t=>{"200000"===t.ret&&(this.rigthsList=t.data,this.openGradeList=t.data.filter(e=>e.status>0),this.listLen=this.rigthsList.length,e&&e())})},openOrClose(e,t){let s=e.status,r=e.id;if(e.gradeLower>=e.gradeUpper&&s)return this.$message.error("请修改成长值上限"),void this.$set(this.rigthsList[t],"status",0);if(s){let e=!0;this.rigthsList.forEach((r,a)=>{if(a<t&&!r.status)return this.$alert("请先开启低等级，在开启当前等级。","提示",{confirmButtonText:"确定",type:"warning"}),this.$set(this.rigthsList[t],"status",s?0:1),void(e=!1)}),e&&this.switchAPI(s,r,t)}else{if(this.rigthsList.length!=t+1&&this.rigthsList[t+1].status)return this.$alert("请先关闭高等级，在关闭当前等级。","提示",{confirmButtonText:"确定",type:"warning"}),void this.getRightsList();this.$confirm("关闭后消费者将不能享受当前的级别的权益，未避免投诉，请谨慎操作。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.switchAPI(s,r,t)}).catch(()=>{this.$set(this.rigthsList[t],"status",1),this.$message({type:"info",message:"已取消关闭"})})}},switchAPI(e,t,s){this.$request.post("/api/wiseqr/mbgrade/updateStatus",{id:t,status:e},!0,t=>{"200000"===t.ret?this.$message.success(e?"开启成功":"关闭成功"):(this.$message.error(t.message),this.$set(this.rigthsList[s],"status",e?0:1))})},edit(e,t){let s=null;if(this.rigthsList[t+1]&&(s=this.rigthsList[t+1].gradeUpper-1),0==t&&e)return this.$router.push(`/customer/lvl/edit?id=${e.id}&highGrowth=${s}`);let r=this.rigthsList[t-1].gradeUpper;if(e)return this.$router.push(`/customer/lvl/edit?id=${e.id}&lowGrowth=${r}&highGrowth=${s}`);0!=this.rigthsList.length?this.$router.push(`/customer/lvl/edit?lowGrowth=${r}&highGrowth=${s}`):this.$router.push("/customer/lvl/edit")}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("div",{staticClass:"wrapper"},e._l(10,function(t,r){return s("div",{key:r,staticClass:"item"},[s("p",{staticClass:"name"},[e._v(e._s(t)+"."+e._s(e.rigthsList[r]?e.rigthsList[r].gradeName:"普通用户"))]),e._v(" "),s("img",{attrs:{src:e.rigthsList[r]?e.rigthsList[r].gradeImg:"https://qoss.qrmkt.cn/new_platform/pc_front/rifhts-default-img"+t+".png",width:"83",height:"83"}}),e._v(" "),s("p",{staticClass:"growth"},[e._v("需要"+e._s(void 0!=e.rigthsList[r]?e.rigthsList[r].gradeLower:"")+"成长值")]),e._v(" "),s("div",{staticClass:"rights"},[r<e.listLen?s("p",[s("span",[e._v("等级权益")]),s("span",[e._v(e._s(e.rigthsList[r]?e.rigthsList[r].rightsNum:0))])]):e._e()]),e._v(" "),r<=e.listLen?s("div",{staticClass:"btn"},[r<e.listLen?s("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(t){return e.openOrClose(e.rigthsList[r],r)}},model:{value:e.rigthsList[r].status,callback:function(t){e.$set(e.rigthsList[r],"status",t)},expression:"rigthsList[index].status"}}):e._e(),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.edit(e.rigthsList[r],r)}}},[e._v("编辑")])],1):e._e()])}),0)])],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("C2L1")},"data-v-1df1dcb8",null);t.default=i.exports},C2L1:function(e,t){},FM6b:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:()=>({selectedType:1,selectedTime:"",options:{"绑定手机号":1,"扫码赚成长值":2,"完善个人资料":3,"关注":4,"签到":5}}),methods:{}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("任务明细")])],1),e._v(" "),s("el-card",[s("el-card",[s("el-form",{attrs:{inline:""}},[s("el-form-item",{attrs:{label:"任务名称："}},[s("el-input",{attrs:{placeholder:"请输入任务名称"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"任务类型："}},[s("el-select",{model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},e._l(e.options,function(e,t){return s("el-option",{key:e,attrs:{label:t,value:e}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"用户名称："}},[s("el-input",{attrs:{placeholder:"请输入用户昵称"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"时间："}},[s("el-date-picker",{attrs:{type:"daterange",format:"yyyy/MM/dd","value-format":"yyyy/MM/dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.c},model:{value:e.selectedTime,callback:function(t){e.selectedTime=t},expression:"selectedTime"}})],1)],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{palin:""}},[e._v("重置")])],1)],1),e._v(" "),s("el-button",{staticClass:"mt20 mb20",attrs:{type:"primary"}},[e._v("导出")]),e._v(" "),s("el-table",{attrs:{border:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"任务名称",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"任务类型",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"用户昵称",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"手机号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"用户等级",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"参与时间",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"获得积分",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"获得成长值",align:"center"}})],1)],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("fQ8x")},"data-v-43aabd83",null);t.default=i.exports},I5Wa:function(e,t){},S104:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={props:["id"],data(){var e=(e,t,s)=>{s()};return{rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],taskDetail:[{required:!0,message:"请输入任务说明",trigger:"blur"}],brand:[{required:!0,validator:e}],item:[{required:!0,validator:e}]},uploadApi:"/api/wiseqr/attach/commonAliUpload",headerObj:{loginId:sessionStorage.getItem("access_loginId")||"2d07e7953a2a63ceda6df5144d1abec3",token:sessionStorage.getItem("access_token"),CLIENTSESSIONID:sessionStorage.getItem("CLIENTSESSIONID")},selectBrand:[],selectSonBrand:[],brandList:[],brandSonList:[],sizeList:[],allLen:null,data:{mbTask:{taskName:"",taskImg:"",taskDetail:"",growthUpperLimit:null},taskSnList:[]}}},created(){this.getBrandList()},mounted(){this.getDetail()},methods:{getDetail(){if(!this.id)return this.$router.push("/customer/task");const e=this.$loading({target:".el-card"});this.$request.post("/api/wiseqr/mber/detTaskById",{id:this.id},!0,t=>{"200000"===t.ret&&(this.data=t.data,0!=t.data.taskSnList.length?(this.sizeList=JSON.parse(JSON.stringify(t.data.taskSnList)),this.adverseSelection(()=>e.close())):e.close())})},save(){this.$refs.form.validate(e=>{return e?0!=this.sizeList.filter(e=>!e.score||!e.growth).length?this.$message.error("请输入积分或成长值!"):0==this.sizeList.length?this.$message.error("请选择品牌规格!"):(this.data.taskSnList=this.sizeList,void this.$request.post("/api/wiseqr/mber/saveBasic",this.data,!0,e=>{if("200000"===e.ret)return this.$message.success("保存成功"),void this.$router.push("/customer/task");this.$message.error(e.message)})):this.$message.error("请完善表单数据!")})},reset(){this.getDetail()},updataList(){if(this.sizeList.length>this.selectSonBrand.length)this.sizeList.forEach((e,t)=>{this.selectSonBrand.includes(e.sn)||this.sizeList.splice(t,1)});else{let e=this.brandSonList.filter(e=>e.sn==this.selectSonBrand[this.selectSonBrand.length-1]),t=JSON.parse(JSON.stringify(e[0]));t.name=t.brandName+"   "+t.allName,t.allName=t.name,this.sizeList.push(JSON.parse(JSON.stringify(t)))}},del(e){this.$confirm("是否删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.sizeList.splice(e,1),this.selectSonBrand.splice(e,1),this.$message({type:"success",message:"删除成功!"})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},adverseSelection(e){let t=[],s=[];this.data.taskSnList.map(e=>{t.push(e.brandCode),s.push(e.sn)}),t=[...new Set(t)],this.selectBrand=t,this.getBrandSonList(()=>{this.selectSonBrand=s,e&&e()})},allSelected(){if(this.allLen==this.selectSonBrand.length)return;const e=this.$loading({target:".el-card"});this.brandList.forEach(e=>{this.selectBrand=[],this.selectBrand.push(e.brandCode)}),this.getBrandSonList(()=>{let t=[],s=JSON.stringify(this.sizeList);this.brandSonList.forEach(e=>{-1==s.indexOf(e.sn)&&t.push(e)}),t.map(e=>{e.name=e.brandName+"   "+e.allName,e.allName=e.name}),this.sizeList.push(...t),this.allLen=this.sizeList.length,this.selectSonBrand=[],this.sizeList.forEach(e=>{this.selectSonBrand.push(e.sn)}),e.close()})},getBrandList(){this.$request.post("/api/wiseqr/prod/listBrand",{pageSize:"-1"},!0,e=>{"200000"!==e.ret?this.$message.error(e.message):this.brandList=e.data.list})},getBrandSonList(e){this.$request.post("/api/wiseqr/prod/list",{brandCodeArr:this.selectBrand,pageSize:"-1"},!0,t=>{if("200000"===t.ret)return this.brandSonList=t.data.list,void(e&&e());this.$message.error(t.message)})},uploadSuccess(e,t,s){if("200000"===e.ret)return this.data.mbTask.taskImg=e.data.accessUrl,void this.$refs.form.validateField("taskImg",e=>{});this.$message.error(e.message)},uploadError(e){console.log(e),alert("图片上传失败")},beforeAvatarUpload(e){const t="image/jpeg"===e.type||"image/png"===e.type,s=e.size/1024/1024<2;return t||this.$message.error("上传图片只能是 JPG 、 PNG 格式!"),s||this.$message.error("上传图片大小不能超过 2MB!"),t&&s}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("el-form",{ref:"form",attrs:{model:e.data.mbTask,"label-width":"100px",rules:e.rules}},[s("el-form-item",{attrs:{label:"任务名称：",prop:"taskName"}},[s("el-input",{attrs:{maxlength:"15"},model:{value:e.data.mbTask.taskName,callback:function(t){e.$set(e.data.mbTask,"taskName",t)},expression:"data.mbTask.taskName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"品牌规格：",prop:"brand"}},[s("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.getBrandSonList},model:{value:e.selectBrand,callback:function(t){e.selectBrand=t},expression:"selectBrand"}},e._l(e.brandList,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.brandCode}})}),1),e._v(" "),s("el-select",{attrs:{"no-data-text":"请选择品牌",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.updataList},model:{value:e.selectSonBrand,callback:function(t){e.selectSonBrand=t},expression:"selectSonBrand"}},e._l(e.brandSonList,function(e){return s("el-option",{key:e.id,attrs:{label:e.allName,value:e.sn}})}),1),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.allSelected}},[e._v("全选")]),e._v(" "),s("el-button",{attrs:{type:"warning"},on:{click:e.reset}},[e._v("重置")])],1),e._v(" "),0!=e.sizeList.length?s("div",e._l(e.sizeList,function(t,r){return s("el-form-item",{key:r,attrs:{label:"规格：",prop:"item"}},[s("el-input",{staticStyle:{width:"240px"},attrs:{disabled:!0},model:{value:t.name,callback:function(s){e.$set(t,"name",s)},expression:"item.name"}}),e._v("\n          商品价格：\n          "),s("el-input-number",{attrs:{disabled:"true",controls:!1},model:{value:t.price,callback:function(s){e.$set(t,"price",s)},expression:"item.price"}}),e._v("\n          元\n          "),s("span",{staticClass:"ml20"},[e._v("获得")]),e._v(" "),s("el-input-number",{attrs:{controls:!1,min:0,max:1e6,precision:0},model:{value:t.score,callback:function(s){e.$set(t,"score",s)},expression:"item['score']"}}),e._v("\n          积分\n          "),s("el-input-number",{attrs:{controls:!1,min:0,max:1e6,precision:0},model:{value:t.growth,callback:function(s){e.$set(t,"growth",s)},expression:"item['growth']"}}),e._v("\n          成长值\n          "),s("el-button",{staticClass:"ml20",attrs:{type:"danger"},on:{click:function(t){return e.del(r)}}},[e._v("删除")])],1)}),1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"任务说明：",prop:"taskDetail"}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容",maxlength:20},model:{value:e.data.mbTask.taskDetail,callback:function(t){e.$set(e.data.mbTask,"taskDetail",t)},expression:"data.mbTask.taskDetail"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"扫码限制："}},[e._v("\n        每人每天最多可获得 \n        "),s("el-input-number",{attrs:{controls:!1,min:0,max:1e6,precision:0},model:{value:e.data.mbTask.growthUpperLimit,callback:function(t){e.$set(e.data.mbTask,"growthUpperLimit",t)},expression:"data.mbTask.growthUpperLimit"}}),e._v("\n        成长值\n      ")],1)],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{plain:""},on:{click:function(t){return e.$router.back(-1)}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("/fde")},"data-v-23ab7876",null);t.default=i.exports},U4iu:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:()=>({total:100,load:!0,queryParams:{mobile:"",nickName:"",gradeNumber:"",pageNo:1,pageSize:10,ban:0},userDetailImgUrl:"http://qrmkt.oss-cn-beijing.aliyuncs.com/common/user-detail-img.png",rules:{nickName:[{max:32,message:"用户昵称长度不能超过 32 位",trigger:"blur"}],mobile:[{max:11,message:"手机号长度为11位",trigger:"blur"}],gradeNumber:[{min:1,max:3,message:"用户等级应为 1 到 3 位",trigger:"blur"}]},userList:[]}),mounted(){this.getUserList()},methods:{getUserList(){this.$refs.queryRef.validate(e=>{if(!e)return this.$message.error("请完善手机号!");this.load=!0,this.$request.post("/api/wiseqr/mber/listUser",this.queryParams,!0,e=>{if("200000"===e.ret)return this.load=!1,this.userList=e.data.list,void(this.total=e.data.page.count);this.$message.error(e.message)})})},addBlack(e){this.$confirm("加入黑名单后，该用户将无法领取活动奖品，无法获取积分及成长值，无法兑换商品，确认加入黑名单吗？ ","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$request.post("/api/wiseqr/mber/upUserBan",{id:e,ban:1},!0,e=>{if("200000"===e.ret)return this.$message.success("加入黑名单成功"),void this.getUserList();this.$message.error(e.message)})}).catch(()=>{this.$message.info("已取消")})},isNum(e){isNaN(e)&&(this.queryParams.gradeNumber="")},reset(){this.queryParams.pageNo=1,this.$refs.queryRef.resetFields(),this.getUserList()},handleCurrentChange(e){this.queryParams.pageNo=e,this.getUserList()}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("el-card",{staticClass:"mb20"},[s("el-form",{ref:"queryRef",attrs:{model:e.queryParams,inline:"",rules:e.rules}},[s("el-form-item",{attrs:{label:"昵称：",prop:"nickName"}},[s("el-input",{model:{value:e.queryParams.nickName,callback:function(t){e.$set(e.queryParams,"nickName",t)},expression:"queryParams.nickName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"手机号：",prop:"mobile"}},[s("el-input",{model:{value:e.queryParams.mobile,callback:function(t){e.$set(e.queryParams,"mobile",t)},expression:"queryParams.mobile"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"用户等级：",prop:"gradeNumber"}},[s("el-input",{on:{change:e.isNum},model:{value:e.queryParams.gradeNumber,callback:function(t){e.$set(e.queryParams,"gradeNumber",t)},expression:"queryParams.gradeNumber"}})],1)],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.getUserList}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{plain:""},on:{click:e.reset}},[e._v("重置")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],attrs:{data:e.userList,border:""}},[s("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"头像",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("img",{attrs:{src:t.row.headimg||e.userDetailImgUrl,width:"40px",height:"40px"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"用户昵称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:t.row.scribeStatus?"red":""},[e._v(e._s(t.row.nickname))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"手机号",prop:"mobile",align:"center",width:"120px"}}),e._v(" "),s("el-table-column",{attrs:{label:"性别",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s("1"==t.row.gender?"男":"女")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"等级",prop:"gradeNumber",align:"center",width:"60px"}}),e._v(" "),s("el-table-column",{attrs:{label:"积分",prop:"points",align:"center",width:"100px"}}),e._v(" "),s("el-table-column",{attrs:{label:"成长值",prop:"growth",align:"center",width:"100px"}}),e._v(" "),s("el-table-column",{attrs:{label:"地区",align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.province)+e._s(t.row.city)+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"注册时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.scribeTime?new Date(t.row.scribeTime).Format("yyyy-MM-dd"):"")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.$router.push("/customer/mgr/detail?id="+t.row.id)}}},[e._v("查看详情")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.addBlack(t.row.id)}}},[e._v("加入黑名单")])]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"mt20",attrs:{background:"","current-page":e.queryParams.pageNo,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("1AdJ")},"data-v-6a23af38",null);t.default=i.exports},Zlrt:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={props:["id","lowGrowth","highGrowth"],data(){return{uploadApi:"/api/wiseqr/attach/commonAliUpload",headerObj:{loginId:sessionStorage.getItem("access_loginId")||"2d07e7953a2a63ceda6df5144d1abec3",token:sessionStorage.getItem("access_token"),CLIENTSESSIONID:sessionStorage.getItem("CLIENTSESSIONID")},conf:{mgrade:{gradeName:"",gradeLower:null,gradeUpper:null,gradeImg:"http://qrmkt.oss-cn-beijing.aliyuncs.com/new_platform/pc_front/rifhts-default-img.png"},mgrsList:[]},rules:{gradeName:[{required:!0,message:"请输入等级名称",trigger:"blur"}],gradeNum:[{required:!0,validator:(e,t,s)=>{this.conf.mgrade.gradeLower>=this.conf.mgrade.gradeUpper?s(new Error("成长值下限必须大于成长值上限")):this.conf.mgrade.gradeUpper?this.highGrowth&&this.conf.mgrade.gradeUpper>=this.highGrowth?s(new Error("成长值上限不能大于上一级的成长值上限")):s():s(new Error("请输入成长值"))},trigger:"blur"}],gradeImg:[{required:!0,validator:(e,t,s)=>{this.conf.mgrade.gradeImg?s():s(new Error("请上传等级图标"))},trigger:"change"}],rights:[{required:!0,validator:(e,t,s)=>{s()}}]},high:sessionStorage.getItem("max"),birthScoreFlg:0,birthGrowthFlg:0,upGradeScoreFlg:0,upGradeGrowthFlg:0,rightsList:[{selected:0,rightsName:"生日权益",rightsCode:"BIRTHDAY_RIGHT",rightsBirSmsFlg:0,rightsScore:"",rightsGrowth:""},{selected:0,rightsName:"积分加速",rightsCode:"SCORE_ACCELERATE",ritsSmallTimes:""},{selected:0,rightsName:"成长值加速",rightsCode:"GROWTH_ACCELERATE",ritsSmallTimes:""},{selected:0,rightsName:"积分商城兑换",rightsCode:"SCORE_MALL_EXCHANGE",ritsSmallTimes:""},{selected:0,rightsName:"品鉴福利",rightsCode:"TASTING_RIGHT"},{selected:0,rightsName:"升级奖励",rightsCode:"UPGRADE_AWARDS_BIGHT",rightsScore:"",rightsGrowth:""}]}},watch:{birthScoreFlg(e){!e&&(this.rightsList[0].rightsScore=0)},birthGrowthFlg(e){!e&&(this.rightsList[0].rightsGrowth=0)},upGradeScoreFlg(e){!e&&(rightsList[5].rightsScore=0)},upGradeGrowthFlg(e){!e&&(rightsList[5].rightsGrowth=0)}},created(){},mounted(){this.getRightsDetail(),this.id||this.lowGrowth&&(this.conf.mgrade.gradeLower=+this.lowGrowth+1)},methods:{getRightsDetail(){if(!this.id)return;const e=this.$loading({target:".el-card"});this.$request.post("/api/wiseqr/mbgrade/detail",{id:this.id},!0,t=>{if("200000"!==t.ret)this.$message.error(t.message);else{if(this.conf=t.data,this.lowGrowth&&(this.conf.mgrade.gradeLower=+this.lowGrowth+1),e.close(),!this.conf.mgrsList)return;t.data.mgrsList.forEach(e=>{switch(e.rightsCode){case"BIRTHDAY_RIGHT":this.rightsList[0]=e,this.$set(this.rightsList[0],"selected",1),this.rightsList[0].rightsScore?this.birthScoreFlg=1:this.birthScoreFlg=0,this.rightsList[0].rightsGrowth?this.birthGrowthFlg=1:this.birthGrowthFlg=0;break;case"SCORE_ACCELERATE":this.rightsList[1]=e,this.$set(this.rightsList[1],"selected",1);break;case"GROWTH_ACCELERATE":this.rightsList[2]=e,this.$set(this.rightsList[2],"selected",1);break;case"SCORE_MALL_EXCHANGE":this.rightsList[3]=e,this.$set(this.rightsList[3],"selected",1);break;case"TASTING_RIGHT":this.rightsList[4]=e,this.$set(this.rightsList[4],"selected",1);break;case"UPGRADE_AWARDS_BIGHT":this.rightsList[5]=e,this.$set(this.rightsList[5],"selected",1),this.rightsList[5].rightsScore?this.upGradeScoreFlg=1:this.upGradeScoreFlg=0,this.rightsList[5].rightsGrowth?this.upGradeGrowthFlg=1:this.upGradeGrowthFlg=0}})}})},save(){this.$refs.rigthsEditRef.validate(e=>{if(!e)return this.$message.error("请完善表单数据!");let t=[];if(this.rightsList.forEach((e,s)=>{switch(s){case 0:e.selected&&(e.rightsBirSmsFlg||e.rightsGrowth||e.rightsScore)&&t.push(e);break;case 1:case 2:case 3:e.selected&&e.ritsSmallTimes&&t.push(e);break;case 4:e.selected&&t.push(e);break;case 5:e.selected&&(e.rightsGrowth||e.rightsScore)&&t.push(e)}}),0==t.length)return this.$message.error("请选择用户权益!");this.conf.mgrsList=t,this.$request.post("/api/wiseqr/mbgrade/saveOrupdate",this.conf,!0,e=>{if("200000"===e.ret)return this.$message.success("保存成功"),void this.$router.push("/customer/lvl");this.$message.error(e.message)})})},uploadSuccess(e,t,s){this.conf.mgrade.gradeImg=e.data.accessUrl},uploadError(e){console.log(e),alert("图片上传失败")},beforeAvatarUpload(e){const t="image/jpeg"===e.type||"image/png"===e.type||"image/bmp"===e.type||"image/gif"===e.type;return t||this.$message.error("上传图片只能是 JPG 、 PNG 、 GIF 、 BMP 格式!"),t}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"conteiner"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("编辑等级")])],1),e._v(" "),s("el-card",[s("el-form",{ref:"rigthsEditRef",attrs:{model:e.conf.mgrade,"label-width":"120px",rules:e.rules}},[s("el-form-item",{attrs:{label:"等级名称：",prop:"gradeName"}},[s("el-input",{attrs:{maxlength:8},model:{value:e.conf.mgrade.gradeName,callback:function(t){e.$set(e.conf.mgrade,"gradeName",t)},expression:"conf.mgrade.gradeName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"需要成长值：",prop:"gradeNum"}},[s("el-input-number",{attrs:{disabled:e.lowGrowth,controls:!1,min:0,max:999999999,precision:0},model:{value:e.conf.mgrade.gradeLower,callback:function(t){e.$set(e.conf.mgrade,"gradeLower",t)},expression:"conf.mgrade.gradeLower"}}),e._v("\n        -\n        "),s("el-input-number",{attrs:{controls:!1,min:0,max:999999999,precision:0},model:{value:e.conf.mgrade.gradeUpper,callback:function(t){e.$set(e.conf.mgrade,"gradeUpper",t)},expression:"conf.mgrade.gradeUpper"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"等级图标：",prop:"gradeImg"}},[s("div",{staticClass:"img"},[s("img",{attrs:{src:e.conf.mgrade.gradeImg}})]),e._v(" "),s("el-upload",{staticClass:"upload",attrs:{action:e.uploadApi,headers:e.headerObj,"show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadError}},[s("el-button",{attrs:{type:"primary"}},[e._v("更换图片")])],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"用户权益：",prop:"rights"}},[s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[0].selected,callback:function(t){e.$set(e.rightsList[0],"selected",t)},expression:"rightsList[0].selected"}},[e._v("生日福利")]),e._v(" "),e.rightsList[0].selected?s("div",{staticClass:"ml40"},[s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[0].rightsBirSmsFlg,callback:function(t){e.$set(e.rightsList[0],"rightsBirSmsFlg",t)},expression:"rightsList[0].rightsBirSmsFlg"}},[e._v("生日短信(生日享受祝福短信)")])],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.birthScoreFlg,callback:function(t){e.birthScoreFlg=t},expression:"birthScoreFlg"}},[e._v("赠送积分")]),e._v(" "),s("el-input-number",{staticClass:"num-input",attrs:{disabled:!e.birthScoreFlg,controls:!1,max:1e6,min:0,precision:0},on:{change:function(e){return isNaN()}},model:{value:e.rightsList[0].rightsScore,callback:function(t){e.$set(e.rightsList[0],"rightsScore",t)},expression:"rightsList[0].rightsScore"}}),e._v("\n              积分\n            ")],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.birthGrowthFlg,callback:function(t){e.birthGrowthFlg=t},expression:"birthGrowthFlg"}},[e._v("赠送成长值")]),e._v(" "),s("el-input-number",{staticClass:"num-input",attrs:{disabled:!e.birthGrowthFlg,controls:!1,min:0,max:1e6,precision:0},model:{value:e.rightsList[0].rightsGrowth,callback:function(t){e.$set(e.rightsList[0],"rightsGrowth",t)},expression:"rightsList[0].rightsGrowth"}}),e._v("\n              成长值\n            ")],1)]):e._e()],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[1].selected,callback:function(t){e.$set(e.rightsList[1],"selected",t)},expression:"rightsList[1].selected"}},[e._v("积分加速")]),e._v(" "),s("el-input-number",{attrs:{disabled:!e.rightsList[1].selected,controls:!1,min:1,precision:2},model:{value:e.rightsList[1].ritsSmallTimes,callback:function(t){e.$set(e.rightsList[1],"ritsSmallTimes",t)},expression:"rightsList[1].ritsSmallTimes"}}),e._v(" 倍\n          "),s("span",{staticClass:"ml20 tips"},[e._v("做任务、签到获取的积分根据配置进行翻倍")])],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[2].selected,callback:function(t){e.$set(e.rightsList[2],"selected",t)},expression:"rightsList[2].selected"}},[e._v("成长值加速")]),e._v(" "),s("el-input-number",{attrs:{disabled:!e.rightsList[2].selected,controls:!1,min:1,precision:2},model:{value:e.rightsList[2].ritsSmallTimes,callback:function(t){e.$set(e.rightsList[2],"ritsSmallTimes",t)},expression:"rightsList[2].ritsSmallTimes"}}),e._v(" 倍\n          "),s("span",{staticClass:"ml20 tips"},[e._v("做任务、签到获取的成长值根据配置进行翻倍")])],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[3].selected,callback:function(t){e.$set(e.rightsList[3],"selected",t)},expression:"rightsList[3].selected"}},[e._v("积分商城兑换")]),e._v(" "),s("el-input-number",{attrs:{disabled:!e.rightsList[3].selected,controls:!1,min:0,max:10,precision:2},model:{value:e.rightsList[3].ritsSmallTimes,callback:function(t){e.$set(e.rightsList[3],"ritsSmallTimes",t)},expression:"rightsList[3].ritsSmallTimes"}}),e._v(" 折\n          "),s("span",{staticClass:"ml20 tips"},[e._v("积分商城兑换商品可以享受的折扣")])],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[4].selected,callback:function(t){e.$set(e.rightsList[4],"selected",t)},expression:"rightsList[4].selected"}},[e._v("品鉴福利(获取品鉴资格)")])],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.rightsList[5].selected,callback:function(t){e.$set(e.rightsList[5],"selected",t)},expression:"rightsList[5].selected"}},[e._v("升级奖励")]),e._v(" "),s("span",{staticClass:"ml20 tips"},[e._v("每升一级可获得以下奖励")]),e._v(" "),e.rightsList[5].selected?s("div",{staticClass:"ml40"},[s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.upGradeScoreFlg,callback:function(t){e.upGradeScoreFlg=t},expression:"upGradeScoreFlg"}},[e._v("赠送积分")]),e._v(" "),s("el-input-number",{attrs:{disabled:!e.upGradeScoreFlg,controls:!1,max:1e6,min:0,precision:0},model:{value:e.rightsList[5].rightsScore,callback:function(t){e.$set(e.rightsList[5],"rightsScore",t)},expression:"rightsList[5].rightsScore"}}),e._v("\n              积分\n            ")],1),e._v(" "),s("div",[s("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.upGradeGrowthFlg,callback:function(t){e.upGradeGrowthFlg=t},expression:"upGradeGrowthFlg"}},[e._v("赠送成长值")]),e._v(" "),s("el-input-number",{attrs:{disabled:!e.upGradeGrowthFlg,controls:!1,max:1e6,min:0,precision:0},model:{value:e.rightsList[5].rightsGrowth,callback:function(t){e.$set(e.rightsList[5],"rightsGrowth",t)},expression:"rightsList[5].rightsGrowth"}}),e._v("\n              成长值\n            ")],1)]):e._e()],1)])],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),s("el-button",{staticClass:"ml20",attrs:{plain:""},on:{click:function(t){return e.$router.back(-1)}}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("1Z9c")},"data-v-567693ed",null);t.default=i.exports},bgzL:function(e,t){},fQ8x:function(e,t){},sS4i:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={props:{id:{redirect:!0}},data:()=>({load:!0,userDetailImgUrl:"http://qrmkt.oss-cn-beijing.aliyuncs.com/common/user-detail-img.png",userInfo:{},pointsList:[],growthList:[],tabsActive:1,pointsQuery:{openid:"",pageNo:1,pageSize:10},rightsQuery:{openid:"",pageNo:1,pageSize:10},total:0,dialogVisible:!1,changeNum:null}),watch:{tabsActive(e){1==e?this.getUserPoints():this.getUserGrowth()}},created(){if(!this.id)return this.$router.push("/customer/mgr")},mounted(){const e=this.$loading({target:".el-card"});this.getUsreInfo(()=>e.close())},methods:{getUsreInfo(e){this.$request.post("/api/wiseqr/mber/detailById",{id:this.id},!0,t=>{if("200000"===t.ret)return this.userInfo=t.data,this.getUserPoints(),void(e&&e());this.$message.error(t.message)})},getUserPoints(){this.load=!0,this.pointsQuery.openid=this.userInfo.openid,this.$request.post("/api/wiseqr/mber/listUPTxn",this.pointsQuery,!0,e=>{"200000"===e.ret&&(this.load=!1,this.pointsList=e.data.list,this.total=e.data.page.count)})},getUserGrowth(){this.load=!0,this.rightsQuery.openid=this.userInfo.openid,this.$request.post("/api/wiseqr/mber/listURights",this.pointsQuery,!0,e=>{"200000"===e.ret&&(this.load=!1,this.growthList=e.data.list,this.total=e.data.page.count)})},handleClick(){},changeScore(){return isNaN(this.changeNum)?this.$message.warning("请输入数字"):+this.changeNum>1e6?this.$message.warning("增加积分数值不能大于一百万"):+this.changeNum+this.userInfo.points<0?this.$message.warning("用户积分不够扣减，请重新输入"):void this.$request.post("/api/wiseqr/mber/addAndSubtPoints",{openid:this.userInfo.openid,points:this.changeNum},!0,e=>{"200000"===e.ret?this.getUsreInfo():this.$message.error(e.message),this.dialogVisible=!1})},handleCurrentChange(e){1==this.tabsActive?(this.pointsQuery.pageNo=e,this.getUserPoints()):(this.rightsQuery.pageNo=e,this.getUserGrowth())}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("el-card",[s("h3",[e._v("个人信息")]),e._v(" "),s("div",{staticClass:"con"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:e.userInfo.headimg||e.userDetailImgUrl}})]),e._v(" "),s("div",{staticClass:"right"},[s("p",[s("span",{staticClass:"mr20"},[e._v(e._s(e.userInfo.nickname))]),e._v(" "),s("span",[e._v(e._s(1==e.userInfo.gender?"男":"女"))])]),e._v(" "),s("p",[e.userInfo.gradeImg?s("img",{staticClass:"gradeImg",attrs:{src:e.userInfo.gradeImg,width:"20",height:"20"}}):e._e(),s("span",[e._v(e._s(e.userInfo.gradeName))])]),e._v(" "),s("p",{staticClass:"info"},[e._v("\n          联系方式："),s("span",[e._v(e._s(e.userInfo.mobile))]),e._v("\n          生日："),s("span",[e._v(e._s(e.userInfo.birthday))]),e._v("\n          注册时间："),s("span",[e._v(e._s(e.userInfo.scribeTime?new Date(e.userInfo.scribeTime).Format("yyyy-MM-dd"):""))])]),e._v(" "),s("p",{staticClass:"info"},[e._v("\n          所属地区："),s("span",[e._v(e._s(e.userInfo.province)+e._s(e.userInfo.city))])]),e._v(" "),s("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.dialogVisible=!0}}},[e._v("增减积分")]),e._v(" "),s("div",{staticClass:"asset"},[s("div",{staticClass:"score"},[s("div",{staticClass:"title"},[e._v("用户积分")]),e._v(" "),s("div",{staticClass:"num"},[e._v(e._s(e.userInfo.points))])]),e._v(" "),s("div",{staticClass:"growth"},[s("div",{staticClass:"title"},[e._v("用户成长值")]),e._v(" "),s("div",{staticClass:"num"},[e._v(e._s(e.userInfo.growth))])])]),e._v(" "),s("div",{staticClass:"tabs"},[s("div",{class:1==e.tabsActive?"active":"",on:{click:function(t){e.tabsActive=1}}},[e._v("积分明细")]),s("div",{class:2==e.tabsActive?"active":"",on:{click:function(t){e.tabsActive=2}}},[e._v("权益明细")])]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"},{name:"show",rawName:"v-show",value:1==e.tabsActive,expression:"tabsActive == 1"}],attrs:{border:"",data:e.pointsList,stripe:!0}},[s("el-table-column",{attrs:{label:"积分变动时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.createTime?new Date(t.row.createTime).Format("yyyy-MM-dd hh:mm:ss"):"")+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作人",prop:"modifier",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"积分变动明细",prop:"txnDesc",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"明细",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.txnType?t.row.txnPoints:"-"+t.row.txnPoints)+"\n            ")]}}])})],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"},{name:"show",rawName:"v-show",value:2==e.tabsActive,expression:"tabsActive == 2"}],attrs:{border:"",data:e.growthList,stripe:!0}},[s("el-table-column",{attrs:{label:"用户权益名称",prop:"rightsName",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"使用情况",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.useFlg?"已使用":"未使用")+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"有效期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.expiratTime?new Date(t.row.expiratTime).Format("yyyy-MM-dd hh:mm:ss"):"")+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"来源",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              LV"+e._s(t.row.gradeCode)+"用户特权\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"获取日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.expiratTime?new Date(t.row.expiratTime).Format("yyyy-MM-dd hh:mm:ss"):"")+"\n            ")]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"mt20",attrs:{background:"","current-page":1==e.tabsActive?e.pointsQuery.pageNo:e.rightsQuery.pageNo,"page-size":1==e.tabsActive?e.pointsQuery.pageSize:e.rightsQuery.pageSize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)]),e._v(" "),s("el-dialog",{attrs:{title:"增减积分",visible:e.dialogVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){e.changeNum=null}}},[s("el-input",{attrs:{placeholder:"请输入要加/减的积分值（-1代表减1积分）"},model:{value:e.changeNum,callback:function(t){e.changeNum=t},expression:"changeNum"}}),e._v(" "),s("div",{staticClass:"mt20",staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.changeScore}},[e._v("确定")]),e._v(" "),s("el-button",{attrs:{plain:""},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("bgzL")},"data-v-bf3cb4ec",null);t.default=i.exports}});
//# sourceMappingURL=9.ca069c59f835ff5779ba.js.map