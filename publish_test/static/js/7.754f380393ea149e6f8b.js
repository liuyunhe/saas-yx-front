webpackJsonp([7],{"+eTV":function(e,t){},"06Bw":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({loading:!1,types:[],pickerOptions:{disabledDate:e=>e.getTime()>Date.now(),onPick(e){}},form:{pageNo:1,pageSize:10,operType:"",time:[],stime:"",etime:"",userName:""},tableList:[],pagination:{total:0}}),created(){let e=new Date;this.form.time=[e.Format("yyyy-MM-dd")+" 00:00:00",e],this.getTypes(),this.list()},methods:{currentChange(e){this.list(event,e)},sizeChange(e){this.list(event,null,e)},getTypes(){this.$request.post("/api/saotx/log/types",{pageSize:-1},!0,e=>{"200000"==e.ret&&(this.types=e.data||{})})},resetForm(){this.form={pageNo:1,pageSize:10,operType:"",stime:"",etime:"",userName:""};let e=new Date;this.form.time=[e.Format("yyyy-MM-dd")+" 00:00:00",e],this.list()},initPagination(e){e&&(this.pagination.total=e.count)},list(e,t,a){this.form.pageNo=t||1,this.form.pageSize=a||10,this.loading=!0,this.form.time&&2==this.form.time.length?(this.form.stime=new Date(this.form.time[0]).Format("yyyy-MM-dd hh:mm:ss"),this.form.etime=new Date(this.form.time[1]).Format("yyyy-MM-dd hh:mm:ss")):this.form.stime=this.form.etime="",this.$request.post("/api/saotx/log/list",this.form,!0,e=>{this.loading=!1,"200000"==e.ret?(this.tableList=e.data.list||[],this.initPagination(e.data.page||{})):this.$message.error(e.message)})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"操作类型"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.form.operType,callback:function(t){e.$set(e.form,"operType",t)},expression:"form.operType"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.types,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"时间"}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),a("div"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.list}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableList}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s((e.form.pageNo-1)*e.form.pageSize+t.$index+1)+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operUsername",label:"用户名",align:"center",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{label:"时间",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(new Date(t.row.operTime).Format("yyyy-MM-dd hh:mm:ss"))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"clientIp",label:"IP",align:"center",width:"130"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operName",label:"操作类型",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operBusiness",label:"模块",align:"center",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operContent",label:"操作详情",align:"center"}})],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.form.pageNo,"page-size":e.form.pageSize,total:e.pagination.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("og3I")},"data-v-494b20ba",null);t.default=i.exports},"3MsD":function(e,t){},"4FNl":function(e,t){},A4x9:function(e,t){},H8XT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({statusList:[],form:{pageNo:1,pageSize:10,keywords:"",status:""},pagination:{total:0},tableList:[],roleForm:{show:!1,id:"",roleCode:"",roleName:"",menus:""},menus:{datas:[],defaultExpanded:[],defaultChecked:[],props:{children:"children",label:"label"}}}),created(){this.getStatus(),this.list()},methods:{currentChange(e){this.list(event,e)},sizeChange(e){this.list(event,null,e)},getStatus(){this.$request.post("/api/saotx/dim/dataStatus",{},!1,e=>{"200000"==e.ret&&(this.statusList=e.data||[])})},resetForm(){this.form={pageNo:1,pageSize:10,keywords:"",status:""},this.list()},list(e,t,a){this.form.pageNo=t||1,this.form.pageSize=a||10,this.$request.post("/api/saotx/role/list",this.form,!0,e=>{"200000"==e.ret&&(this.tableList=e.data.list||[],this.initPagination(e.data.page||{}))})},initPagination(e){e&&(this.pagination.total=e.count)},handleDelete(e,t){this.$confirm("停用后，会影响用户的权限，确认操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{this.modifyData(t.id,0)}).catch(()=>{})},modifyData(e,t){let a={id:e,status:t};this.$request.post("/api/saotx/role/mstatus",a,!0,e=>{"200000"==e.ret?(this.list(),this.$message({type:"success",message:"操作成功!"})):this.$message.error(e.message)})},roleFormInit(){this.roleForm={show:!1,id:"",roleCode:"",roleName:"",menus:[]},this.menus={datas:[],defaultExpanded:[],defaultChecked:[],props:{children:"children",label:"label"}}},mgrForm(e,t){t&&t.id?(this.roleForm.id=t.id,this.roleForm.roleCode=t.roleCode,this.roleForm.roleName=t.roleName):this.roleFormInit(),this.$request.post("/api/saotx/role/queryByCode",this.roleForm,!0,e=>{if("200000"==e.ret){this.roleForm.id=e.data.id||"",this.roleForm.roleCode=e.data.roleCode||"",this.roleForm.roleName=e.data.roleName||"";let t=e.data.nodes||[],a=[];for(let e=0;e<t.length;e++){let s=t[e];if(!s.pId){let e={id:s.id,label:s.name,checked:s.checked};this.recursiveMenu(t,e),a.push(e)}}this.menus.datas=a,this.roleForm.show=!0}else this.$message.error(e.message)})},recursiveMenu(e,t){let a=[];for(let s=0;s<e.length;s++){let r=e[s];if(t.id==r.pId){let t={id:r.id,label:r.name,checked:r.checked};this.recursiveMenu(e,t),a.push(t)}}t.children=a,0==t.children.length&&t.checked&&this.menus.defaultChecked.push(t.id)},roleFormOk(){if(!this.roleForm.roleName)return this.$message.error("角色名称不能为空！"),!1;let e=this.$refs.menuTree.getHalfCheckedKeys()||[],t=this.$refs.menuTree.getCheckedKeys()||[];e&&e.length>0&&(e=e.concat(t)),this.roleForm.menus=e.join(",")||"",this.$request.post("/api/saotx/role/saveOrModify",this.roleForm,!0,e=>{"200000"==e.ret?(this.$message({type:"success",message:"操作成功!"}),this.roleForm.show=!1,this.list()):this.$message.error(e.message)})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-row",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.mgrForm}},[e._v("新建角色")])],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{size:"small",placeholder:"模糊查询角色名称"},model:{value:e.form.keywords,callback:function(t){e.$set(e.form,"keywords",t)},expression:"form.keywords"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.statusList,function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1),e._v(" "),a("div"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.list}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableList}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s((e.form.pageNo-1)*e.form.pageSize+t.$index+1)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(1==t.row.status?"已启用":"已停用")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.mgrForm(t.$index,t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),"orgadmin"!=t.row.roleCode&&1==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("停用")]):e._e(),e._v(" "),"orgadmin"!=t.row.roleCode&&0==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.modifyData(t.row.id,1)}}},[e._v("启用")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.form.pageNo,"page-size":e.form.pageSize,total:e.pagination.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"角色管理",width:"550px",center:"",visible:e.roleForm.show},on:{"update:visible":function(t){e.$set(e.roleForm,"show",t)}}},[a("el-form",{staticClass:"form",attrs:{model:e.roleForm}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{size:"small",placeholder:"角色名称",disabled:!!e.roleForm.id},model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"label"},[e._v("权限菜单")]),e._v(" "),a("div",{staticClass:"menu-tree"},[a("el-tree",{ref:"menuTree",attrs:{data:e.menus.datas,"show-checkbox":"","node-key":"id","default-expanded-keys":e.menus.defaultExpanded,"default-checked-keys":e.menus.defaultChecked,props:e.menus.props}})],1)])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.roleForm.show=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.roleFormOk}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("yxOa")},"data-v-5aa41d5e",null);t.default=i.exports},Irwd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({headers:{loginId:sessionStorage.getItem("access_loginId"),token:sessionStorage.getItem("access_token")},allOrgs:[],loading:!1,form:{pageNo:1,pageSize:10,orgId:"",account:"",mobile:""},tableList:[],pagination:{total:0},disabledMenu:"sysOrgResMgr,sysMenuMgr,resourceMgr,",cascadeMenuController:{seller:"sellerothermanage,",mall:"mallSysConf,"},menuTreeDatas:[],treeDatas:[],menuProps:{value:"menuCode",label:"menuName",children:"nodeList"},defaultCheckedMenus:[],defaultExpanded:[],menusValidErr:!1,authForm:{show:!1,roleId:"",orgId:"",account:"",name:"企业管理员",pwd:"123456",mobile:"",roleCode:"",roleName:"",menus:"",roleStatus:""},authFormRules:{orgId:[{required:!0,message:"企业名称不能为空！",trigger:"blur"}],account:[{required:!0,message:"登录账号不能为空！",trigger:"blur"}],roleStatus:[{required:!0,message:"状态不能为空！",trigger:"blur"}]}}),created(){this.getAllOrgs(),this.list(),this.getAllMenus()},methods:{currentChange(e){this.list(event,e)},sizeChange(e){this.list(event,null,e)},getAllOrgs(){this.$request.get("/api/saotx/auth/orgAuth",{},e=>{"200000"==e.ret&&(this.allOrgs=e.data||{})})},getAllMenus(){this.$request.post("/api/saotx/menu/alldata",{service:"saas"},!0,e=>{if("200000"==e.ret){let t=e.data||[];this.disabledMenu&&this.reverseDisabled(t),this.menuTreeDatas=t,this.treeDatas=t}})},reverseDisabled(e,t,a){for(let s=0;s<e.length;s++)if(e[s].nodeList&&e[s].nodeList.length>0&&this.reverseDisabled(e[s].nodeList,t,a),t)-1!=t.indexOf(e[s].menuCode+",")&&(e[s].disabled=!a,this.$refs.treeDatas.setChecked(e[s].menuCode,a,!1));else{e[s].disabled=!1,-1!=this.disabledMenu.indexOf(e[s].menuCode+",")&&(e[s].disabled=!0);for(let t in this.cascadeMenuController)-1!=this.cascadeMenuController[t].indexOf(e[s].menuCode+",")&&(e[s].disabled=!0)}},treeCheckChange(e,t,a){let s=this.cascadeMenuController[e.menuCode];s&&this.reverseDisabled(this.treeDatas,s,t)},resetForm(){this.form={pageNo:1,pageSize:10,orgId:"",account:"",mobile:""},this.list()},initPagination(e){e&&(this.pagination.total=e.count)},list(e,t,a){this.form.pageNo=t||1,this.form.pageSize=a||10,this.loading=!0,this.$request.post("/api/saotx/auth/orgAuthDatas",this.form,!0,e=>{if(this.loading=!1,"200000"==e.ret){this.tableList=e.data.list||[];for(let e=0;e<this.tableList.length;e++){let t=this.tableList[e];for(let e=0;e<this.allOrgs.length;e++)t.orgId==this.allOrgs[e].orgId&&(this.allOrgs[e].auth=1)}this.initPagination(e.data.page||{})}else this.$message.error(e.message)})},edit(e,t){this.authForm={roleId:t.roleId,orgId:t.orgId,account:t.account,name:t.name,mobile:t.mobile,roleCode:t.roleCode,roleName:t.roleName,menus:t.menus,roleStatus:t.roleStatus},this.$request.post("/api/saotx/auth/authMenus",{orgId:t.orgId},!0,e=>{"200000"==e.ret?(this.defaultCheckedMenus=[],e.data&&(this.defaultCheckedMenus=e.data.split(","))):this.$message.error(e.message)}),this.authForm.show=!0},modifyStatus(e,t){let a="";if(1==t)a="启用后，该企业的账号恢复使用SAAS平台，确定操作吗？";else{if(0!=t)return;a="停用后，该企业的账号将无法使用SAAS平台，确定操作吗？"}this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{let a={};a.roleId=e.roleId,a.orgId=e.orgId,a.roleStatus=t,this.$request.post("/api/saotx/auth/mauthStatus",a,!0,e=>{"200000"==e.ret?(this.list(),this.$message({type:"success",message:"操作成功!"})):this.$message.error(e.message)})}).catch(()=>{})},authFormCancel(){this.authForm={show:!1,roleId:"",orgId:"",account:"",name:"企业管理员",pwd:"123456",mobile:"",roleCode:"",roleName:"",menus:"",roleStatus:""},this.$refs.treeDatas.setCheckedKeys([]),this.$refs.authForm.clearValidate();let e=this.$refs.treeDatas.store._getAllNodes();for(let t=0;t<e.length;t++)e[t].expanded=!1},authFormOk(e){this.$refs[e].validate(e=>{let t=this.$refs.treeDatas.getCheckedKeys();if(t&&t.length>0?this.menusValidErr=!1:this.menusValidErr=!0,e&&!this.menusValidErr){let e=this.$refs.treeDatas.getHalfCheckedKeys(),a=e||""||"";a+=t?(a?",":"")+t:"",this.authForm.menus=a,this.$request.post("/api/saotx/auth/somAuth",this.authForm,!0,e=>{"200000"==e.ret?(this.authFormCancel(),this.list()):this.$message.error(e.message)})}})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"auth-container"},[a("el-card",[a("el-row",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.authForm.show=!0}}},[e._v("关联企业")])],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-form",{staticClass:"search-block",attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"企业名称"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.form.orgId,callback:function(t){e.$set(e.form,"orgId",t)},expression:"form.orgId"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.allOrgs,function(e){return a("el-option",{key:e.orgId,class:1==e.auth?"":"hide",attrs:{label:e.orgName,value:e.orgId}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"登录账号"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("div"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.list}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-card",{staticClass:"table-card"},[a("el-table",{staticClass:"table-data",attrs:{data:e.tableList}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s((e.form.pageNo-1)*e.form.pageSize+t.$index+1)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orgName",label:"企业名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"account",label:"登录账号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(1==t.row.roleStatus?"正常":"停用")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(new Date(t.row.roleCtime).Format("yyyy-MM-dd hh:mm:ss"))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.edit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.roleStatus,expression:"scope.row.roleStatus==1"}],attrs:{size:"mini"},on:{click:function(a){e.modifyStatus(t.row,0)}}},[e._v("停用")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.row.roleStatus,expression:"scope.row.roleStatus==0"}],attrs:{size:"mini"},on:{click:function(a){e.modifyStatus(t.row,1)}}},[e._v("启用")])]}}])})],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.form.pageNo,"page-size":e.form.pageSize,total:e.pagination.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"企业授权管理",width:"550px",center:"",visible:e.authForm.show,"show-close":!1},on:{"update:visible":function(t){e.$set(e.authForm,"show",t)}}},[a("el-form",{ref:"authForm",staticClass:"form",attrs:{model:e.authForm,rules:e.authFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"企业名称",prop:"orgId"}},[a("el-select",{attrs:{size:"small",placeholder:"全部",disabled:!!e.authForm.roleId},model:{value:e.authForm.orgId,callback:function(t){e.$set(e.authForm,"orgId",t)},expression:"authForm.orgId"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.allOrgs,function(e){return a("el-option",{key:e.orgId,class:1==e.auth?"hide":"",attrs:{label:e.orgName,value:e.orgId}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名"}},[a("span",[e._v("企业管理员")])]),e._v(" "),a("el-form-item",{attrs:{label:"登录账号",prop:"account"}},[a("el-input",{attrs:{size:"small",placeholder:"系统平台唯一性。例：xxx-admin；user1",disabled:!!e.authForm.roleId},model:{value:e.authForm.account,callback:function(t){e.$set(e.authForm,"account",t)},expression:"authForm.account"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.authForm.roleId,expression:"authForm.roleId?false:true"}],attrs:{label:"登录密码",prop:"pwd"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.authForm.pwd,callback:function(t){e.$set(e.authForm,"pwd",t)},expression:"authForm.pwd"}}),e._v(" "),a("div",{staticClass:"error-tip"},[e._v("初始登录密码系统默认生成，用户首次登录时需及时修改")])],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{size:"small"},model:{value:e.authForm.mobile,callback:function(t){e.$set(e.authForm,"mobile",t)},expression:"authForm.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("span",[e._v("企业管理员角色")])]),e._v(" "),a("el-form-item",{attrs:{label:"菜单权限",required:""}},[a("div",{staticClass:"menu-tree"},[a("el-tree",{ref:"treeDatas",attrs:{data:e.treeDatas,props:e.menuProps,"node-key":"menuCode","default-checked-keys":e.defaultCheckedMenus,"default-expanded-keys":e.defaultExpanded,"show-checkbox":""},on:{"check-change":e.treeCheckChange}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.menusValidErr,expression:"menusValidErr"}],staticClass:"el-form-item__error"},[e._v("菜单授权不能为空！")])]),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"roleStatus"}},[a("el-radio",{attrs:{label:1},model:{value:e.authForm.roleStatus,callback:function(t){e.$set(e.authForm,"roleStatus",t)},expression:"authForm.roleStatus"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0},model:{value:e.authForm.roleStatus,callback:function(t){e.$set(e.authForm,"roleStatus",t)},expression:"authForm.roleStatus"}},[e._v("禁用")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.authFormCancel()}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.authFormOk("authForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("v60n")},"data-v-a967d44e",null);t.default=i.exports},KkD4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({headers:{loginId:sessionStorage.getItem("access_loginId"),token:sessionStorage.getItem("access_token")},loading:!1,form:{menuName:"",status:""},tableList:[],tableOriList:[],filterText:"",treeDatas:[],defaultProps:{children:"nodeList",label:"menuName"},menuProps:{value:"menuCode",label:"menuName",children:"nodeList"},menuParentDatas:[],menuForm:{show:!1,id:"",menuCode:"",menuName:"",parents:[],oldParentCode:"",parentCode:"",menuUrl:"",icon:"",activeIcon:"",note:"",status:""},menuFormRules:{menuCode:[{required:!1,validator:(e,t,a)=>{t.length>30?a(new Error("菜单编码不能超过30个字符！")):a()},trigger:"blur"}],menuName:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("菜单名称不能为空！")):t.length>10?a(new Error("菜单名称不能超过10个字符！")):a()},trigger:"blur"}],menuUrl:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("菜单链接地址不能为空！")):t.length>100?a(new Error("菜单链接地址不能超过100个字符！")):a()},trigger:"blur"}],status:[{required:!0,message:"状态不能为空！",trigger:"blur"}]},menuClickNode:null}),watch:{filterText(e){this.$refs.treeDatas.filter(e)}},created(){this.initTree()},mounted(){},methods:{filterNode:(e,t)=>!e||-1!==t.menuName.indexOf(e),initTree(){this.$request.post("/api/saotx/menu/alldata",{service:"saas"},!0,e=>{"200000"==e.ret&&(this.treeDatas=e.data||[],this.tableList=e.data||[],this.tableOriList=e.data||[],this.initFormParent())})},initFormParent(){this.menuParentDatas=[];for(let e=0;e<this.treeDatas.length;e++){let t=this.treeDatas[e],a={menuCode:t.menuCode,menuName:t.menuName,parent:t.parentCode,nodeList:[]},s=t.nodeList;if(s&&s.length>0)for(let e=0;e<s.length;e++){let r=s[e],i={menuCode:r.menuCode,menuName:r.menuName,parent:t.menuCode};a.nodeList.push(i)}this.menuParentDatas.push(a)}},treeNodeClick(e,t){if(this.tableOriList=[],this.tableOriList.push(e),e.nodeList&&e.nodeList.length>0)for(let t=0;t<e.nodeList.length;t++)this.tableOriList.push(e.nodeList[t]);this.tableList=this.tableOriList,this.menuClickNode=e},currentChange(e){this.search(event,e)},sizeChange(e){this.search(event,null,e)},search(){if(this.form.menuName||this.form.status){this.tableList=[];for(let e=0;e<this.tableOriList.length;e++){let t=this.tableOriList[e];this.form.menuName&&this.form.status?-1!=t.menuName.indexOf(this.form.menuName)&&this.form.status==t.status&&this.tableList.push(t):this.form.menuName&&-1!=t.menuName.indexOf(this.form.menuName)?this.tableList.push(t):this.form.status&&this.form.status==t.status&&this.tableList.push(t)}}else this.tableList=this.tableOriList},resetForm(){this.form={menuName:"",status:""},this.search()},createMenu(){this.menuForm.show=!0},edit(e,t){let a=t.parentCode;if(this.menuForm={show:!0,id:t.id,menuCode:t.menuCode,menuName:t.menuName,oldParentCode:a,parentCode:a,menuUrl:t.menuUrl,icon:t.icon,activeIcon:t.activeIcon,note:t.note,status:t.status},a){this.menuForm.parents=[];for(let e=0;e<this.menuParentDatas.length;e++){let t=this.menuParentDatas[e];if(a==t.menuCode)return this.menuForm.parents.push(t.parent),void this.menuForm.parents.push(a);for(let e=0;e<t.nodeList.length;e++){let s=t.nodeList[e];if(a==s.menuCode)return this.menuForm.parents.push(s.parent),void this.menuForm.parents.push(a)}}}},modifyStatus(e,t){let a="";if(1==t)a="启用后，所有授权过此菜单的企业中都将变更为启用，确定操作吗？";else{if(2!=t)return;a="禁用后，所有授权过此菜单的企业中都将变更为禁用，确定操作吗？"}this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{let a={};a.id=e,a.status=t,a.service="saas",this.$request.post("/api/saotx/menu/modifyStatus",a,!0,e=>{"200000"==e.ret?(this.initTree(),this.$message({type:"success",message:"操作成功!"})):this.$message.error(e.message)})}).catch(()=>{})},remove(e,t){this.$confirm("删除后，所有授权过此菜单的企业中都将被删除，确定操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{let e={};e.id=t.id,e.status=0,e.service="saas",this.$request.post("/api/saotx/menu/modifyStatus",e,!0,e=>{"200000"==e.ret?(this.initTree(),this.menuFormCancel("menuForm"),this.$message({type:"success",message:"操作成功!"})):this.$message.error(e.message)})}).catch(()=>{})},menuFormCancel(e){this.menuForm={show:!1,id:"",menuCode:"",menuName:"",parents:[],oldParentCode:"",parentCode:"",menuUrl:"",icon:"",activeIcon:"",note:"",status:""},this.$refs[e].clearValidate()},menuFormOk(e){this.$refs[e].validate(e=>{e&&(this.menuForm.parents&&this.menuForm.parents.length>0?this.menuForm.parentCode=this.menuForm.parents[this.menuForm.parents.length-1]:this.menuForm.parentCode="",this.$request.post("/api/saotx/menu/somsys",this.menuForm,!0,e=>{"200000"==e.ret?(this.$message({type:"success",message:"操作成功！刷新页面后可见菜单展示！"}),this.initTree(),this.menuFormCancel("menuForm")):this.$message.error(e.message)}))})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menu-container"},[a("div",{staticClass:"lcontent"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-tree",{ref:"treeDatas",staticClass:"filter-tree",attrs:{data:e.treeDatas,props:e.defaultProps,"filter-node-method":e.filterNode,"expand-on-click-node":!1},on:{"node-click":e.treeNodeClick}})],1),e._v(" "),a("div",{staticClass:"rcontent"},[a("el-card",[a("el-row",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.createMenu}},[e._v("新建")])],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-form",{staticClass:"search-block",attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"菜单名称"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入菜单名称"},model:{value:e.form.menuName,callback:function(t){e.$set(e.form,"menuName",t)},expression:"form.menuName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._v(" "),a("el-option",{attrs:{label:"可见",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"不可见",value:"2"}})],1)],1),e._v(" "),a("div"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-card",{staticClass:"table-card"},[a("el-table",{staticClass:"table-data",attrs:{data:e.tableList}},[a("el-table-column",{attrs:{prop:"menuName",label:"菜单姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"parent.menuName",label:"上级菜单",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"menuUrl",label:"链接地址",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{class:1==t.row.status?"used":"unused"},[e._v(e._s(t.row.statusName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(new Date(t.row.ctime).Format("yyyy-MM-dd hh:mm:ss"))+"\n              ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.edit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),2==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.modifyStatus(t.row.id,1)}}},[e._v("启用")]):e._e(),e._v(" "),1==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.modifyStatus(t.row.id,2)}}},[e._v("禁用")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.remove(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"space"})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:(e.menuForm.id?"编辑":"新建")+"菜单资源管理",width:"550px",center:"",visible:e.menuForm.show},on:{"update:visible":function(t){e.$set(e.menuForm,"show",t)},closed:function(t){e.menuFormCancel("menuForm")}}},[a("el-form",{ref:"menuForm",staticClass:"form",attrs:{model:e.menuForm,rules:e.menuFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"菜单编码",prop:"menuCode"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入不超过30个字符",disabled:!!e.menuForm.id},model:{value:e.menuForm.menuCode,callback:function(t){e.$set(e.menuForm,"menuCode",t)},expression:"menuForm.menuCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入不超过10个字符"},model:{value:e.menuForm.menuName,callback:function(t){e.$set(e.menuForm,"menuName",t)},expression:"menuForm.menuName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级菜单",prop:"parentCode"}},[a("el-cascader",{attrs:{size:"small",placeholder:"请选择",props:e.menuProps,options:e.menuParentDatas,clearable:"","change-on-select":"",filterable:""},model:{value:e.menuForm.parents,callback:function(t){e.$set(e.menuForm,"parents",t)},expression:"menuForm.parents"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"链接地址",prop:"menuUrl"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入页面访问url，不能超过100个字符"},model:{value:e.menuForm.menuUrl,callback:function(t){e.$set(e.menuForm,"menuUrl",t)},expression:"menuForm.menuUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"默认图标"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"/api/saotx/attach/commonAliUpload",headers:e.headers,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.menuForm.icon?a("img",{staticClass:"avatar",attrs:{src:e.menuForm.icon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("图片建议尺寸为14*14px")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"选中图标"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"/api/saotx/attach/commonAliUpload",headers:e.headers,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.menuForm.activeIcon?a("img",{staticClass:"avatar",attrs:{src:e.menuForm.activeIcon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("图片建议尺寸为14*14px")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"备注描述"}},[a("el-input",{attrs:{size:"small",type:"textarea",rows:2,placeholder:""},model:{value:e.menuForm.note,callback:function(t){e.$set(e.menuForm,"note",t)},expression:"menuForm.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio",{attrs:{label:1},model:{value:e.menuForm.status,callback:function(t){e.$set(e.menuForm,"status",t)},expression:"menuForm.status"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.menuForm.status,callback:function(t){e.$set(e.menuForm,"status",t)},expression:"menuForm.status"}},[e._v("禁用")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.menuFormCancel("menuForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.menuFormOk("menuForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("A4x9")},"data-v-429ecc98",null);t.default=i.exports},KxUm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({cluser:{account:"",orgName:""},roleList:[],statusList:[],form:{pageNo:1,pageSize:10,keywords:"",roleCode:"",status:""},pagination:{total:0},tableList:[],userForm:{showClose:!1,show:!1,orgName:"",id:"",account:"",name:"",mobile:"",email:"",pwd:"",roleCode:""},userFormRules:{account:[{required:!0,message:"账号不能为空",trigger:"blur"}],name:[{required:!0,message:"账号昵称不能为空",trigger:"blur"}],mobile:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("手机号不能为空")):/^1[0-9]{2}\d{8}$/.test(t)?a():a(new Error("手机号格式错误！"))},trigger:"blur"}],email:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("邮箱不能为空")):/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(t)?a():a(new Error("邮箱格式错误！"))},trigger:"blur"}],pwd:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("密码不能为空")):/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?]+)$)^[\w~!@#$%\^&*?]{8,16}$/.test(t)?a():a(new Error("8-16位字符(至少包含字母、数字、符号中的两种形式)"))},trigger:"blur"}],roleCode:[{required:!0,message:"角色不能为空",trigger:"blur"}]}}),created(){if(this.cluser=this.$store.state.cluser,!this.cluser||!this.cluser.account)return this.clearLoginSession(),!1;this.getRoleList(),this.list()},methods:{clearLoginSession(){sessionStorage.removeItem("access_token"),sessionStorage.removeItem("access_loginId")},currentChange(e){this.list(event,e)},sizeChange(e){this.list(event,null,e)},getRoleList(){this.$request.post("/api/saotx/role/list",{pageSize:-1},!0,e=>{"200000"==e.ret&&(this.roleList=e.data.list||[])})},resetForm(){this.form={pageNo:1,pageSize:10,keywords:"",roleCode:"",status:""},this.list()},list(e,t,a){this.form.pageNo=t||1,this.form.pageSize=a||10,this.$request.post("/api/saotx/user/list",this.form,!0,e=>{"200000"==e.ret&&(this.tableList=e.data.list||[],this.initPagination(e.data.page||{}))})},initPagination(e){e&&(this.pagination.total=e.count)},handleDelete(e,t){this.$confirm("停用后，此用户将无法登陆平台系统，确认操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{this.modifyData(t.id,0)}).catch(()=>{})},modifyData(e,t){let a={id:e,status:t};this.$request.post("/api/saotx/user/mstatus",a,!0,e=>{"200000"==e.ret?(this.list(),this.$message({type:"success",message:"操作成功!"})):this.$message.error(e.message)})},mgrForm(e,t){t&&(this.userForm=Object.assign({},this.userForm,t)),this.userForm.show=!0},userFormCancel(e){this.userForm={showClose:!1,show:!1,orgName:"",id:"",account:"",name:"",mobile:"",email:"",pwd:"",roleCode:""},this.$refs[e].clearValidate()},userFormOk(e){this.$refs[e].validate(e=>{if(e){let e=this.userForm.pwd;e&&(this.userForm.pwd=this.$md5(e)),this.$request.post("/api/saotx/user/saveOrModify",this.userForm,!0,t=>{"200000"==t.ret?(this.list(),this.userFormCancel("userForm"),this.$message({type:"success",message:"操作成功!"})):(this.userForm.pwd=e,this.$message.error(t.message))})}})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-row",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.mgrForm}},[e._v("新建成员")])],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"成员筛选"}},[a("el-input",{attrs:{size:"small",placeholder:"姓名/手机号"},model:{value:e.form.keywords,callback:function(t){e.$set(e.form,"keywords",t)},expression:"form.keywords"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.roleList,function(e){return a("el-option",{key:e.roleCode,attrs:{label:e.roleName,value:e.roleCode}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"已启用",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已停用",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"已锁定",value:"2"}})],1)],1),e._v(" "),a("div"),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.list}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-card",{staticClass:"box-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableList}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s((e.form.pageNo-1)*e.form.pageSize+t.$index+1)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orgName",label:"单位",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(1==t.row.status?"已启用":2==t.row.status?"已锁定":"已停用")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.mgrForm(t.$index,t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),"orgadmin"!=t.row.roleCode&&1==t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("停用")]):e._e(),e._v(" "),"orgadmin"!=t.row.roleCode&&0==t.row.status?a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.modifyData(t.row.id,1)}}},[e._v("启用")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"space"}),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.form.pageNo,"page-size":e.form.pageSize,total:e.pagination.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"成员管理",width:"550px",center:"",visible:e.userForm.show,"show-close":e.userForm.showClose},on:{"update:visible":function(t){e.$set(e.userForm,"show",t)}}},[a("el-form",{ref:"userForm",staticClass:"form",attrs:{model:e.userForm,rules:e.userFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"公司"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.cluser.orgName,callback:function(t){e.$set(e.cluser,"orgName",t)},expression:"cluser.orgName"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"账号id",prop:"id"}},[a("el-input",{attrs:{size:"small"},model:{value:e.userForm.id,callback:function(t){e.$set(e.userForm,"id",t)},expression:"userForm.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{size:"small",placeholder:"登录账号",disabled:!!e.userForm.id},model:{value:e.userForm.account,callback:function(t){e.$set(e.userForm,"account",t)},expression:"userForm.account"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"账号昵称",disabled:!!e.userForm.id},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{size:"small",placeholder:"账号绑定手机号"},model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{size:"small",placeholder:"常用邮箱"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),e._v(" "),e.userForm.id?e._e():a("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[a("el-input",{attrs:{size:"small",type:"password",placeholder:"8-16位字符(至少包含字母、数字、符号中的两种形式)"},model:{value:e.userForm.pwd,callback:function(t){e.$set(e.userForm,"pwd",t)},expression:"userForm.pwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"roleCode"}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:e.userForm.roleCode,callback:function(t){e.$set(e.userForm,"roleCode",t)},expression:"userForm.roleCode"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.roleList,function(e){return a("el-option",{key:e.roleCode,attrs:{label:e.roleName,value:e.roleCode}})})],2)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.userFormCancel("userForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.userFormOk("userForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("lgDg")},"data-v-3d4f602e",null);t.default=i.exports},MILx:function(e,t){},MQ6R:function(e,t){},NlvI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({yearList:[{name:"",val:1},{name:"",val:1},{name:"3年后",val:1},{name:"4年后",val:1},{name:"5年后",val:1}],selectedYear:"",isVaild:null,data:{orgPorList:[{propKey:"score_expiratione_time",propValue:"",propDesc:"积分有效期"},{propKey:"score_protion_value",propValue:"",propDesc:"积分值配置"},{propKey:"score_name_config",propValue:"",propDesc:"积分名称配置"}]}}),created(){this.handleTime()},mounted(){const e=this.$loading({target:".el-card"});this.getDetail(()=>e.close())},methods:{getDetail(e){this.$request.post("/api/saotx/mber/scoreDetail",{},!0,t=>{if("200000"===t.ret)return 0!=t.data.orgPorList.length&&(this.data=t.data),"-1"==this.data.orgPorList[0].propValue?this.isVaild=0:this.data.orgPorList[0].propValue&&"-1"!=this.data.orgPorList[0].propValue&&(this.isVaild=1,this.selectedYear=this.data.orgPorList[0].propValue),void(e&&e());this.$message.error(t.message)})},handleTime(){let e=(new Date).getFullYear();this.yearList[0].name=`明年(${e+1})`,this.yearList[1].name=`后年(${e+2})`,this.yearList[0].val=e+1+"",this.yearList[1].val=e+2+"",this.yearList[2].val=e+3+"",this.yearList[3].val=e+4+"",this.yearList[4].val=e+5+""},save(){0==this.isVaild?this.data.orgPorList[0].propValue="-1":1==this.isVaild&&(this.data.orgPorList[0].propValue=this.selectedYear),this.data.orgPorList[1].propValue+="";this.data.orgPorList.filter(e=>e.propValue);this.$request.post("/api/saotx/mber/saveScore",this.data,!0,e=>{if("200000"===e.ret)return this.$message.success("保存成功");this.$message.error(e.message)})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-card",{staticClass:"content"},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"积分过期设置："}},[a("div",[a("el-radio",{attrs:{label:0},model:{value:e.isVaild,callback:function(t){e.isVaild=t},expression:"isVaild"}},[e._v("永久有效")])],1),e._v(" "),a("div",[a("el-radio",{attrs:{label:1},model:{value:e.isVaild,callback:function(t){e.isVaild=t},expression:"isVaild"}},[e._v("积分有效期为")]),e._v(" "),a("el-select",{attrs:{disabled:!e.isVaild},model:{value:e.selectedYear,callback:function(t){e.selectedYear=t},expression:"selectedYear"}},e._l(e.yearList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.val}})})),e._v(" "),a("el-popover",{attrs:{placement:"bottom",width:"400",trigger:"hover"}},[a("p",[e._v("\n              例如，设置为“1年”，即表示在今年（2018）获得的用户积分将在2018年12月31号23:59:59失效\n              "),a("br"),e._v(" "),a("span",{style:{"margin-top":"10px",color:"#0000FF"}},[e._v("\n                修改有效期只作用于未来获得的积分，请谨慎修改以防争议\n              ")])]),e._v(" "),a("el-button",{staticClass:"tips",attrs:{slot:"reference",circle:"",plain:""},slot:"reference"},[e._v(" ? ")])],1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"积分值配置："}},[a("el-input-number",{attrs:{controls:!1,min:0,max:9999999999,precision:0},model:{value:e.data.orgPorList[1].propValue,callback:function(t){e.$set(e.data.orgPorList[1],"propValue",t)},expression:"data.orgPorList[1].propValue"}}),e._v(" \n        积分 = ￥1.00\n      ")],1),e._v(" "),a("el-form-item",{attrs:{label:"积分名称设置："}},[a("el-input",{attrs:{placeholder:"请输入积分名称"},model:{value:e.data.orgPorList[2].propValue,callback:function(t){e.$set(e.data.orgPorList[2],"propValue",t)},expression:"data.orgPorList[2].propValue"}}),e._v("\n        例如： 积分 = 金叶币\n      ")],1)],1),e._v(" "),a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("4FNl")},"data-v-c9297576",null);t.default=i.exports},X9mQ:function(e,t){},YSTz:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({form:{time:!1,timeText:"",showGetQr:!1,printQr:!1,printMoney:"",auditingMoney:""}}),created(){this.initSettings()},methods:{initSettings(){this.$request.post("/lsh/seller-manager/setting/querySysSetting",{},!0,e=>{if(e.ok){let t=e.data||{};this.form.time=1==t.SELLER_CONSUMER_ISSET,this.form.timeText=t.SELLER_CONSUMER_THRESHOLD||"",this.form.showGetQr=1==t.SELLER_QRPRINT_SHOW_ISSET,this.form.printQr=1==t.SELLER_QRPRINT_CHARGE_ISSET,this.form.printMoney=t.SELLER_QRPRINT_CHARGE_STANDARD||"",this.form.auditingMoney=t.SELLER_TX_AMOUNT_AUTH||""}})},save(){let e={SELLER_CONSUMER_ISSET:0,SELLER_CONSUMER_THRESHOLD:"",SELLER_QRPRINT_SHOW_ISSET:0,SELLER_QRPRINT_CHARGE_ISSET:0,SELLER_QRPRINT_CHARGE_STANDARD:"",SELLER_TX_AMOUNT_AUTH:this.form.auditingMoney};if(this.form.time){if(e.SELLER_CONSUMER_ISSET=1,!this.form.timeText)return this.$message.error("店铺与消费者关联时间不能为空，并且必须大于0！"),!1;e.SELLER_CONSUMER_THRESHOLD=this.form.timeText}this.form.showGetQr&&(e.SELLER_QRPRINT_SHOW_ISSET=1),this.form.printQr&&(e.SELLER_QRPRINT_CHARGE_ISSET=1,e.SELLER_QRPRINT_CHARGE_STANDARD=this.form.printMoney),this.$request.post("/lsh/seller-manager/setting/sellerSysSetting",{settings:e},!0,e=>{e.ok?this.$message({type:"success",message:"保存成功!"}):this.$message.error("保存失败，请稍候再试或联系管理员！")})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"zxwm-setting"},[a("el-card",{staticClass:"setting-card"},[a("ul",{},[a("li",[a("p",{staticClass:"title"},[e._v("店铺与消费者关联时间设置：")]),e._v(" "),a("div",[e._v("\n                    是否开启：\n                    "),a("el-switch",{attrs:{size:"small","active-color":"#13ce66","inactive-color":"#eeeeee"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}}),e._v(" "),a("el-input-number",{directives:[{name:"show",rawName:"v-show",value:e.form.time,expression:"form.time"}],attrs:{size:"small","controls-position":"right",min:1,max:2147483647},model:{value:e.form.timeText,callback:function(t){e.$set(e.form,"timeText",t)},expression:"form.timeText"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.time,expression:"form.time"}],staticClass:"unit-info"},[e._v("单位：分钟")])],1)]),e._v(" "),a("li",[a("p",{staticClass:"title"},[e._v("零售户首页是否显示领取店码标牌设置：")]),e._v(" "),a("div",[e._v("\n                    是否显示：\n                    "),a("el-switch",{attrs:{size:"small","active-color":"#13ce66","inactive-color":"#eeeeee"},model:{value:e.form.showGetQr,callback:function(t){e.$set(e.form,"showGetQr",t)},expression:"form.showGetQr"}})],1)]),e._v(" "),a("li",[a("p",{staticClass:"title"},[e._v("店码二维码打印设置：")]),e._v(" "),a("div",[e._v("\n                    是否收费（含运费和税费）：\n                    "),a("el-switch",{attrs:{size:"small","active-color":"#13ce66","inactive-color":"#eeeeee"},model:{value:e.form.printQr,callback:function(t){e.$set(e.form,"printQr",t)},expression:"form.printQr"}}),e._v(" "),a("el-input-number",{directives:[{name:"show",rawName:"v-show",value:e.form.printQr,expression:"form.printQr"}],attrs:{size:"small","controls-position":"right",min:0,max:2147483647},model:{value:e.form.printMoney,callback:function(t){e.$set(e.form,"printMoney",t)},expression:"form.printMoney"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.printQr,expression:"form.printQr"}],staticClass:"unit-info"},[e._v("单位：元")])],1)]),e._v(" "),a("li",{staticClass:"last"},[a("p",{staticClass:"title"},[e._v("提现申请阀值设置：")]),e._v(" "),a("div",[e._v("\n                    提现需申请阀值金额：\n                    "),a("el-input-number",{attrs:{size:"small","controls-position":"right",min:0,max:2147483647},model:{value:e.form.auditingMoney,callback:function(t){e.$set(e.form,"auditingMoney",t)},expression:"form.auditingMoney"}}),e._v(" "),a("span",{staticClass:"unit-info"},[e._v("单位：元")])],1)])]),e._v(" "),a("div",{staticClass:"oper-block"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.save}},[e._v("保存")])],1)])],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("+eTV")},"data-v-4a5475f5",null);t.default=i.exports},"ab+u":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data(){return{cluser:{},form:{oldPwd:"",newPwd:"",checkPass:""},rules:{oldPwd:[{required:!0,message:"原密码不能为空",trigger:"blur"}],newPwd:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("请输入密码")):/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?]+)$)^[\w~!@#$%\^&*?]{8,16}$/.test(t)?(""!==this.form.checkPass&&this.$refs.form.validateField("checkPass"),a()):a(new Error("8-16位字符(至少包含字母、数字、符号中的两种形式)"))},trigger:"blur"}],checkPass:[{required:!0,validator:(e,t,a)=>{""===t?a(new Error("请输入确认密码")):t!==this.form.newPwd?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]}}},created(){if(this.cluser=this.$store.state.cluser,!this.cluser||!this.cluser.account)return this.clearLoginSession(),!1},methods:{clearLoginSession(){sessionStorage.removeItem("access_token"),sessionStorage.removeItem("access_loginId")},submitForm(e){this.$refs[e].validate(e=>{if(e){let e={};e.account=this.cluser.account,e.oldPwd=this.form.oldPwd,e.newPwd=this.$md5(this.form.newPwd),this.$request.post("/api/saotx/user/modifyPwd",e,!0,e=>{"200000"==e.ret?(this.clearLoginSession(),this.$router.push({path:"/login"})):this.$message.error(e.message)})}})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",staticClass:"mod-pwd",attrs:{model:e.form,rules:e.rules,"label-width":"120px","status-icon":""}},[a("el-form-item",{attrs:{label:"原密码",prop:"oldPwd"}},[a("el-input",{attrs:{size:"small",type:"password"},model:{value:e.form.oldPwd,callback:function(t){e.$set(e.form,"oldPwd",t)},expression:"form.oldPwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[a("el-input",{attrs:{size:"small",type:"password"},model:{value:e.form.newPwd,callback:function(t){e.$set(e.form,"newPwd",t)},expression:"form.newPwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{size:"small",type:"password"},model:{value:e.form.checkPass,callback:function(t){e.$set(e.form,"checkPass",t)},expression:"form.checkPass"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("确认")])],1)],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("dWwy")},"data-v-f932cf30",null);t.default=i.exports},bX27:function(e,t){},dWwy:function(e,t){},ehVw:function(e,t,a){"use strict";var s={props:["editData","shareConf"],data:()=>({uploadApi:"/api/saotx/attach/commonAliUpload",headerObj:{loginId:sessionStorage.getItem("access_loginId")||"2d07e7953a2a63ceda6df5144d1abec3",token:sessionStorage.getItem("access_token"),CLIENTSESSIONID:sessionStorage.getItem("CLIENTSESSIONID")}}),created(){},methods:{uploadSuccess(e,t,a){let s=e.data.accessUrl;this.editData[0].url=s,this.$emit("shareChange",{url:s})},uploadError(e){alert("图片上传失败")},beforeAvatarUpload(e){const t="image/jpeg"===e.type||"image/png"===e.type||"image/bmp"===e.type||"image/gif"===e.type;return t||this.$message.error("上传图片只能是 JPG 、 PNG 、 GIF 、 BMP 格式!"),t}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-share"},[a("el-card",{staticClass:"card"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h3",[e._v("编辑图片")])]),e._v(" "),a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分享标题："}},[a("el-input",{attrs:{type:"text",maxlength:15},model:{value:e.shareConf.shareTitle,callback:function(t){e.$set(e.shareConf,"shareTitle",t)},expression:"shareConf.shareTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分享说明："}},[a("el-input",{staticStyle:{width:"70%"},attrs:{maxlength:"30",type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.shareConf.shareDesc,callback:function(t){e.$set(e.shareConf,"shareDesc",t)},expression:"shareConf.shareDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分享图标："}},[a("div",[a("div",{staticClass:"img"},[a("img",{attrs:{src:e.editData[0].url}})]),e._v(" "),a("el-upload",{staticClass:"upload",attrs:{action:e.uploadApi,headers:e.headerObj,"show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadError}},[a("el-button",{attrs:{type:"primary",size:"small"}},[e._v("更换图片")])],1),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("* 图片建议尺寸为 91*91px，格式为*.jpg\\ *.bmp\\ *.png\\ *.gif")])],1)])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("xs42")},"data-v-0bfa23de",null);t.a=i.exports},lgDg:function(e,t){},oTr4:function(e,t){},og3I:function(e,t){},qDRw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={props:{menuArr:{type:[Object,Array],required:!0},page:{type:[String,Number],required:!0}},data:()=>({defaultActive:1}),methods:{switchMenu(e){this.$emit("updataPage",e)}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-menu",{attrs:{mode:"horizontal","default-active":e.defaultActive},on:{select:e.switchMenu}},e._l(e.menuArr,function(t,s){return a("el-menu-item",{key:s,attrs:{index:s+1}},[e._v(e._s(t))])}))],1)},staticRenderFns:[]},i=a("VU/8")(s,r,!1,null,null,null).exports,o={props:{conf:{type:Object,required:!0},page:{}},data:()=>({nowMonth:`${(new Date).getFullYear()}.${(new Date).getMonth()+1}`,weekArr:["日","一","二","三","四","五","六"],dayArr:[],days:null,activeStyle:{background:"#F0CB28",color:"#FCF8F8"},signDayArr:[1,2,4,5,6,7,10,20]}),watch:{},created(){this.days=new Date(this.nowMonth+".1").getDay(),this.handleDayNum()},methods:{handleDayNum(){let e=(new Date).getMonth()+1,t=(new Date).getFullYear(),a=0;switch(e){case 2:a=t%4!=0||t%100==0&&t%400!=0||t%3200==0?28:29;break;case 1:case 3:case 5:case 7:case 8:case 10:case 12:a=31;break;case 4:case 6:case 9:case 11:a=30}this.forDay(a)},forDay(e){this.dayArr=[];for(let t=1;t<=e;t++)this.dayArr.push(t)},handleImg(){},sendImgType(e){8!=this.page&&this.$emit("changeImg",e)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e.conf.imgObj?a("div",{staticClass:"phone-wrapper"},[a("div",{staticClass:"phone-header"},[a("h4",[e._v(e._s(e.conf.title))])]),e._v(" "),a("div",{staticClass:"phone-body"},[1==e.page||8==e.page?a("div",[a("img",{staticClass:"bg page1-bg",style:{width:.4*e.conf.imgObj.page1.bg.size[0]+"px",height:.4*e.conf.imgObj.page1.bg.size[1]+"px",left:.4*e.conf.imgObj.page1.bg.pos[0]+"px",top:.4*e.conf.imgObj.page1.bg.pos[1]+"px"},attrs:{src:e.conf.imgObj.page1.bg.url},on:{click:function(t){e.sendImgType(e.conf.imgObj.page1.bg.type)}}}),e._v(" "),a("img",{staticClass:"rules-btn",style:{width:.4*e.conf.imgObj.page1.rulesBtn.size[0]+"px",height:.4*e.conf.imgObj.page1.rulesBtn.size[1]+"px",left:.4*e.conf.imgObj.page1.rulesBtn.pos[0]+"px",top:.4*e.conf.imgObj.page1.rulesBtn.pos[1]+"px"},attrs:{src:e.conf.imgObj.page1.rulesBtn.url},on:{click:function(t){e.sendImgType(e.conf.imgObj.page1.rulesBtn.type)}}}),e._v(" "),a("img",{staticClass:"draw-btn",style:{width:.4*e.conf.imgObj.page1.drawBtn.size[0]+"px",height:.4*e.conf.imgObj.page1.drawBtn.size[1]+"px",left:.4*e.conf.imgObj.page1.drawBtn.pos[0]+"px",top:.4*e.conf.imgObj.page1.drawBtn.pos[1]+"px"},attrs:{src:e.conf.imgObj.page1.drawBtn.url,alt:""},on:{click:function(t){e.sendImgType(e.conf.imgObj.page1.drawBtn.type)}}}),e._v(" "),a("div",{staticClass:"calendar",on:{click:function(t){e.sendImgType(e.conf.imgObj.page1.calendarHeader.type)}}},[a("div",{staticClass:"header",style:{width:.4*e.conf.imgObj.page1.calendarHeader.size[0]+"px",height:.4*e.conf.imgObj.page1.calendarHeader.size[1]+"px",left:.4*e.conf.imgObj.page1.calendarHeader.pos[0]+"px",top:.4*e.conf.imgObj.page1.calendarHeader.pos[1]+"px",background:"url("+e.conf.imgObj.page1.calendarHeader.url+") no-repeat center / 100% 100%","line-height":.4*e.conf.imgObj.page1.calendarHeader.size[1]+"px"}},[e._v("\n            您已经连续签到 "),a("span",[e._v("3")]),e._v(" 天\n          ")]),e._v(" "),a("div",{staticClass:"con",style:{width:.4*e.conf.imgObj.page1.calendarCon.size[0]+"px",height:.4*e.conf.imgObj.page1.calendarCon.size[1]+"px",left:.4*e.conf.imgObj.page1.calendarCon.pos[0]+"px",top:.4*e.conf.imgObj.page1.calendarCon.pos[1]+"px",background:"url("+e.conf.imgObj.page1.calendarCon.url+") no-repeat center / 100% 100%"}},[a("div",{staticClass:"data-module"},[a("div",{staticClass:"header"},[e._v(e._s(e.nowMonth))]),e._v(" "),a("div",{staticClass:"body"},[e._l(e.weekArr,function(t,s){return a("div",{key:s,staticClass:"item"},[e._v("\n                  "+e._s(t)+"\n                ")])}),e._v(" "),e._l(e.days,function(e,t){return a("div",{key:t,staticClass:"item"})}),e._v(" "),e._l(e.dayArr,function(t,s){return a("div",{key:s,staticClass:"item",style:e.signDayArr.includes(s+1)?e.conf.activeStyle:{}},[e._v("\n                  "+e._s(t)+"\n                ")])})],2)])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:8==e.page,expression:"page == 8"}],staticClass:"mask"})]):e._e(),e._v(" "),1!==e.page&&e.page<7?a("div",[a("div",{staticClass:"bg",style:{width:"300px",height:"484px",background:"rgba(0, 0, 0, 0.8)"}},e._l(e.conf.imgObj["page"+e.page],function(e,t){return a("img",{key:t,style:{width:.4*e.size[0]+"px",height:.4*e.size[1]+"px",left:.4*e.pos[0]+"px",top:.4*e.pos[1]+"px"},attrs:{src:e.url}})}))]):e._e(),e._v(" "),7==e.page?a("div",[a("div",{staticClass:"share-bg"},[a("div",{staticClass:"text"},[a("h3",{staticClass:"title",domProps:{innerHTML:e._s(e.conf.share.shareTitle?e.conf.share.shareTitle:"扫码验真")}}),e._v(" "),a("p",{staticClass:"desc",domProps:{innerHTML:e._s(e.conf.share.shareDesc?e.conf.share.shareDesc:"扫码验真精彩送不停，更多好礼等级拿！")}}),e._v(" "),a("dic",{staticClass:"img"},[a("img",{attrs:{src:e.conf.imgObj.page7.icon.url+"?"+(new Date).getTime()}})])],1)])]):e._e()]),e._v(" "),a("div",{staticClass:"phone-footer"})]):e._e()])},staticRenderFns:[]};var n=a("VU/8")(o,l,!1,function(e){a("X9mQ")},"data-v-e04c3cca",null).exports,c=a("ifEn"),m=a("UJta"),u=a("9ijK"),d=a("ehVw"),p={props:["data"],data:()=>({num:1,imgURL:"http://qoss.qrmkt.cn/saas_platform/test/55C8950F6B444C8887925C80B3B97B03.png"}),methods:{del(e){this.$confirm("是否删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.data.splice(e,1),this.$message({type:"success",message:"删除成功!"})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},sync(e){this.data[e].quantity=this.data[e].allquantity},addRepertory(e){this.$prompt("请输入数字","增库",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\d{1,}$/,inputErrorMessage:"请输入数字"}).then(({value:t})=>{if(0==t)return this.$message.error("数字不能为0");this.$request.post("/sc/saotx/game/addQuality",{id:this.data[e].id,shopQuantity:t},!0,a=>{200==a.code?(this.$message.success("增库成功"),this.data[e].allquantity+=Number(t),this.data[e].quantity+=Number(t)):this.$message.error(a.message)})}).catch(()=>{this.$message({type:"info",message:"取消输入"})})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-form",{staticClass:"mb20"},e._l(e.data,function(t,s){return a("el-form-item",{key:s},[a("img",{attrs:{src:t.image,width:"40px"}}),e._v(" "),a("p",[e._v(e._s(t.productName))]),e._v("\n      奖品数量：\n      "),a("el-input-number",{attrs:{disabled:!!t.id,controls:!1,min:0,precision:0},on:{change:function(t){e.sync(s)}},model:{value:t.allquantity,callback:function(a){e.$set(t,"allquantity",a)},expression:"item.allquantity"}}),e._v("\n      个\n      "),a("span",[e._v("*")]),e._v("\n      中奖概率\n      "),a("el-input-number",{attrs:{controls:!1,min:0,max:100},model:{value:t.probability,callback:function(a){e.$set(t,"probability",a)},expression:"item.probability"}}),e._v("\n      %\n      "),a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.del(s)}}},[e._v("删除")]),e._v(" "),t.id?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addRepertory(s)}}},[e._v("增库")]):e._e(),e._v(" "),a("span",{staticClass:"residual"},[e._v("剩余"+e._s(t.quantity)+"个")])],1)}))],1)},staticRenderFns:[]};var g=a("VU/8")(p,h,!1,function(e){a("MQ6R")},"data-v-7cd0ef42",null).exports,f={props:{data:{type:Object,required:!0,maxDay:null}},data:()=>({}),created(){this.data.sort(this.compare("continuSignDay")),this.maxDay=this.data[this.data.length-1].continuSignDay},methods:{noRepeat(e,t){let a=!0;this.data.forEach((s,r)=>{if(t!=r)return s.continuSignDay==e?(a=!1,void this.$message.error("连续签到天数不能重复!")):void 0}),a&&(this.data.sort(this.compare("continuSignDay")),this.maxDay=this.data[this.data.length-1].continuSignDay)},add(e){if(this.data.length>=10)return this.$message.error("连续签到设置不能超过10项!");this.data.push({continuSignDay:0,extraScore:0,extraGrowth:0})},del(e){this.$confirm("是否删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.data.splice(e,1),this.$message({type:"success",message:"删除成功!"})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},compare:e=>(function(t,a){return t[e]-a[e]})}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("ul",e._l(e.data,function(t,s){return a("li",{key:s},[e._v("\n      连续签到\n      "),a("el-input-number",{attrs:{controls:!1,min:0,precision:0},on:{change:function(a){e.noRepeat(t.continuSignDay,s)}},model:{value:t.continuSignDay,callback:function(a){e.$set(t,"continuSignDay",a)},expression:"item.continuSignDay"}}),e._v("\n      天，额外可获得\n      "),a("el-input-number",{attrs:{controls:!1,min:0,precision:0},model:{value:t.extraScore,callback:function(a){e.$set(t,"extraScore",a)},expression:"item.extraScore"}}),e._v("\n      积分\n      "),a("el-input-number",{attrs:{controls:!1,min:0,precision:0},model:{value:t.extraGrowth,callback:function(a){e.$set(t,"extraGrowth",a)},expression:"item.extraGrowth"}}),e._v("\n      成长值\n      "),a("el-button",{attrs:{icon:"el-icon-plus",circle:""},on:{click:function(t){e.add(s)}}}),e._v(" "),0!==s?a("el-button",{attrs:{icon:"el-icon-minus",circle:""},on:{click:function(t){e.del(s)}}}):e._e()],1)})),e._v(" "),a("p",{staticClass:"tips"},[e._v("每 "),a("span",[e._v(e._s(e.maxDay))]),e._v(" 天为一个循环, 最多连续签到 "),a("span",[e._v(e._s(e.maxDay))]),e._v(" 天, 断签则从第一天开始重新计算")])])},staticRenderFns:[]};var b=a("VU/8")(f,v,!1,function(e){a("oTr4")},"data-v-4a57744d",null).exports,_=a("G0J2"),y={components:{prizeConf:g,signItem:b,quillEditor:_.quillEditor},props:{conf:{type:Object,required:!0}},data(){var e=(e,t,a)=>{};return{rules:{actName:[{required:!0,message:"请输入活动名称",trigger:"blur"}],signNote:[{required:!0,validator:(e,t,a)=>{this.conf.sactBset.signNote?a():a(new Error("请输入活动说明"))}}],signImg:[{required:!0,validator:e}],share:[{required:!0,validator:e}]},signRules:{awards:[{required:!0,validator:e}],signAwards:[{required:!0,validator:e}]},draw:{draw:[{required:!0,validator:e}],drawChanceFlg:[{required:!0,validator:e}],drawSignDay:[{required:!0,validator:e}]},prize:{selected:[{required:!0,validator:e}]},editorOption:{modules:{toolbar:[[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline","strike",,"blockquote"],[{color:[]},{background:[]},{align:[]}]]},placeholder:"请输入活动说明"},uploadApi:"/api/saotx/attach/commonAliUpload",headerObj:{loginId:sessionStorage.getItem("access_loginId")||"2d07e7953a2a63ceda6df5144d1abec3",token:sessionStorage.getItem("access_token"),CLIENTSESSIONID:sessionStorage.getItem("CLIENTSESSIONID")},imgIndex:0,showFile:!1}},created(){},methods:{getPrize(){this.$emit("getPrize")},onEditorBlur(){},updataImg(e){},uploadSuccess(e,t,a){let s=e.data.accessUrl;1==this.imgIndex?this.conf.sactBset.initBtImage=s:this.conf.sactBset.pressBtImage=s},uploadError(e){console.log(e),this.$message.error("图片上传失败")},beforeAvatarUpload(e){const t="image/jpeg"===e.type||"image/png"===e.type||"image/bmp"===e.type||"image/gif"===e.type;return t||this.$message.error("上传图片只能是 JPG 、 PNG 、 GIF 、 BMP 格式!"),t}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"title ml20 mb20"},[e._v("基础设置")]),e._v(" "),a("el-form",{attrs:{"label-width":"100px",model:e.conf.sactBset,rules:e.rules}},[a("el-form-item",{attrs:{label:"活动名称：",prop:"actName"}},[a("el-input",{attrs:{max:15,min:1},model:{value:e.conf.sactBset.actName,callback:function(t){e.$set(e.conf.sactBset,"actName",t)},expression:"conf.sactBset.actName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"签到入口：",prop:"signImg"}},[a("div",{staticClass:"start ml20"},[a("p",[e._v("初始状态")]),e._v(" "),a("div",{staticClass:"con"},[a("img",{attrs:{src:e.conf.sactBset.initBtImage,title:"初始状态"}})]),e._v(" "),a("el-upload",{staticClass:"upload",attrs:{action:e.uploadApi,headers:e.headerObj,"show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadError}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.imgIndex=1}}},[e._v("更换图片")])],1)],1),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"end"},[a("p",[e._v("按下效果")]),e._v(" "),a("div",{staticClass:"con"},[a("img",{attrs:{src:e.conf.sactBset.pressBtImage,title:"按下效果"}})]),e._v(" "),a("el-upload",{staticClass:"upload",attrs:{action:e.uploadApi,headers:e.headerObj,"show-file-list":!1,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadError}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.imgIndex=2}}},[e._v("更换图片")])],1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"签到规则：",prop:"signNote"}},[a("quill-editor",{ref:"myTextEditor",attrs:{options:e.editorOption,placeholder:"请输入活动说明，300字以内"},on:{blur:function(t){e.onEditorBlur(t)}},model:{value:e.conf.sactBset.signNote,callback:function(t){e.$set(e.conf.sactBset,"signNote",t)},expression:"conf.sactBset.signNote"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分享设置：",prop:"share"}},[a("el-radio",{attrs:{label:1},model:{value:e.conf.sactBset.share,callback:function(t){e.$set(e.conf.sactBset,"share",t)},expression:"conf.sactBset.share"}},[e._v("开启分享")]),e._v(" "),a("el-radio",{attrs:{label:0},model:{value:e.conf.sactBset.share,callback:function(t){e.$set(e.conf.sactBset,"share",t)},expression:"conf.sactBset.share"}},[e._v("关闭分享")])],1)],1),e._v(" "),a("div",{staticClass:"title ml20 mb20"},[e._v("签到设置")]),e._v(" "),a("el-form",{attrs:{"label-width":"130px",rules:e.signRules}},[a("el-form-item",{attrs:{label:"常规签到奖励：",prop:"awards"}},[e._v("\n      每日签到获得\n      "),a("el-input-number",{attrs:{controls:!1,min:0,precision:0},model:{value:e.conf.sactBset.score,callback:function(t){e.$set(e.conf.sactBset,"score",t)},expression:"conf.sactBset.score"}}),e._v("\n      积分\n      "),a("el-input-number",{attrs:{controls:!1,min:0,precision:0},model:{value:e.conf.sactBset.growth,callback:function(t){e.$set(e.conf.sactBset,"growth",t)},expression:"conf.sactBset.growth"}}),e._v("\n      成长值\n    ")],1),e._v(" "),a("el-form-item",{attrs:{label:"连续签到奖励：",prop:"signAwards"}},[a("el-radio",{attrs:{disabled:e.conf.sactBset.status,label:0},model:{value:e.conf.sactBset.continuSignFlg,callback:function(t){e.$set(e.conf.sactBset,"continuSignFlg",t)},expression:"conf.sactBset.continuSignFlg"}},[e._v("关闭")]),e._v(" "),a("el-radio",{attrs:{disabled:e.conf.sactBset.status,label:1},model:{value:e.conf.sactBset.continuSignFlg,callback:function(t){e.$set(e.conf.sactBset,"continuSignFlg",t)},expression:"conf.sactBset.continuSignFlg"}},[e._v("开启")]),e._v(" "),a("sign-item",{directives:[{name:"show",rawName:"v-show",value:1===e.conf.sactBset.continuSignFlg,expression:"conf.sactBset.continuSignFlg === 1"}],attrs:{data:e.conf.contItems}}),e._v(" "),a("div",{staticClass:"tips"},[e._v("发布后不可切换")])],1)],1),e._v(" "),a("div",{staticClass:"title ml20 mb20"},[e._v("抽奖设置")]),e._v(" "),a("el-form",{attrs:{"label-width":"130px",rules:e.draw}},[a("el-form-item",{attrs:{label:"是否关联抽奖：",prop:"drawChanceFlg"}},[a("el-radio",{attrs:{label:0},model:{value:e.conf.sactBset.drawChanceFlg,callback:function(t){e.$set(e.conf.sactBset,"drawChanceFlg",t)},expression:"conf.sactBset.drawChanceFlg"}},[e._v("不关联")]),e._v(" "),a("el-radio",{attrs:{label:1},model:{value:e.conf.sactBset.drawChanceFlg,callback:function(t){e.$set(e.conf.sactBset,"drawChanceFlg",t)},expression:"conf.sactBset.drawChanceFlg"}},[e._v("关联")])],1),e._v(" "),a("el-form-item",{attrs:{label:"抽奖要求：",prop:"drawSignDay"}},[e._v("\n        累计签到\n        "),a("el-input-number",{attrs:{controls:!1,min:1,precision:0},model:{value:e.conf.sactBset.drawSignDay,callback:function(t){e.$set(e.conf.sactBset,"drawSignDay",t)},expression:"conf.sactBset.drawSignDay"}}),e._v("\n        天，可参与抽奖\n      ")],1)],1),e._v(" "),a("div",{staticClass:"title ml20 mb20"},[e._v("奖项设置")]),e._v(" "),a("el-form",{attrs:{"label-width":"100px",rules:e.prize}},[a("el-form-item",{attrs:{label:"选择奖品：",prop:"selected"}},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.getPrize}})],1)],1),e._v(" "),a("p",{staticClass:"ml20"},[e._v("所选礼品：")]),e._v(" "),e.conf.gameItems?a("prize-conf",{staticClass:"ml20",attrs:{data:e.conf.gameItems}}):e._e()],1)},staticRenderFns:[]};var C=a("VU/8")(y,w,!1,function(e){a("tmDH")},"data-v-13ee4bc3",null).exports,x={data:()=>({queryParmes:{pageNo:1,pageSize:5,productId:null,productName:"",giftType:null},queryStr:"",optionArr:[{name:"礼品名称",id:1},{name:"礼品id",id:2}],giftTypeArr:[{name:"虚拟",code:1},{name:"实物",code:2},{name:"红包",code:3},{name:"积分",code:4}],selectedNum:1,selectedTotalGoods:0,selectedGoodsArr:[],dataObj:[{id:1,name:"123",pic:"http://qoss.qrmkt.cn/saas_platform/test/55C8950F6B444C8887925C80B3B97B03.png",type:"活动奖品",sort:"实物",stock:123},{id:1,name:"123",pic:"http://qoss.qrmkt.cn/saas_platform/test/55C8950F6B444C8887925C80B3B97B03.png",type:"活动奖品",sort:"实物",stock:123},{id:1,name:"123",pic:"http://qoss.qrmkt.cn/saas_platform/test/55C8950F6B444C8887925C80B3B97B03.png",type:"活动奖品",sort:"实物",stock:123}],total:3,prizeList:[],giftType:{1:"虚拟",2:"实物",3:"红包",4:"积分"},loading:!0}),created(){this.getPrize()},methods:{getPrize(){this.loading=!0,1==this.selectedNum?(this.queryParmes.productName=this.queryStr,this.queryParmes.productId=""):(this.queryParmes.productId=this.queryStr,this.queryParmes.productName=""),this.$request.post("/sc/saotx/mall/product/listActs",this.queryParmes,!0,e=>{"200000"===e.ret&&(this.loading=!1,this.prizeList=e.data.list,this.total=e.data.page.count)})},confirm(){this.$emit("getSelectedGoodsArr",this.selectedGoodsArr)},close(){this.$emit("close")},selected(e){this.selectedTotalGoods=e.length,this.selectedGoodsArr=e},handleCurrentChange(e){this.queryParmes.pageNo=e,this.getPrize()}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"关键词"}},[a("el-select",{model:{value:e.selectedNum,callback:function(t){e.selectedNum=t},expression:"selectedNum"}},e._l(e.optionArr,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("el-input",{model:{value:e.queryStr,callback:function(t){e.queryStr=t},expression:"queryStr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"礼品类型"}},[a("el-select",{staticClass:"type",attrs:{placeholder:"请选择礼品类型",clearable:""},model:{value:e.queryParmes.giftType,callback:function(t){e.$set(e.queryParmes,"giftType",t)},expression:"queryParmes.giftType"}},e._l(e.giftType,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}))],1)],1),e._v(" "),a("el-button",{staticClass:"mb20",attrs:{type:"primary"},on:{click:e.getPrize}},[e._v("查询")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:!0,data:e.prizeList,"tooltip-effect":"dark"},on:{select:e.selected,"select-all":e.selected}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productId",label:"礼品ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"礼品名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"礼品图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.image,height:"40px",alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"礼品类型",align:"center"}},[[e._v("\n        活动奖品\n      ")]],2),e._v(" "),a("el-table-column",{attrs:{label:"礼品分类",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.giftType[t.row.giftType])+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"shopQuantity",label:"库存",align:"center"}})],1),e._v(" "),a("el-pagination",{staticClass:"mt20",attrs:{background:"","current-page":e.queryParmes.pageNo,"page-size":e.queryParmes.pageSize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("div",{staticClass:"selectedText"},[a("p",[e._v("当前已选"+e._s(e.selectedTotalGoods)+"个商品")])]),e._v(" "),a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.close}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var F=a("VU/8")(x,k,!1,function(e){a("3MsD")},"data-v-7b03dcf2",null).exports,S={props:{imgObj:{type:Object,required:!0},type:{default:1},color:{required:!0}},data:()=>({uploadApi:"/api/saotx/attach/commonAliUpload",headerObj:{loginId:sessionStorage.getItem("access_loginId")||"2d07e7953a2a63ceda6df5144d1abec3",token:sessionStorage.getItem("access_token"),CLIENTSESSIONID:sessionStorage.getItem("CLIENTSESSIONID")},showFile:!1,editIndex:""}),methods:{uploadSuccess(e,t,a){let s=e.data.accessUrl;this.$emit("picChange",{url:s,index:this.editIndex})},uploadError(e){console.log(e),alert("图片上传失败")},onUploadClick(e){this.editIndex=e},beforeAvatarUpload(e){const t="image/jpeg"===e.type||"image/png"===e.type||"image/bmp"===e.type||"image/gif"===e.type;return t||this.$message.error("上传图片只能是 JPG 、 PNG 、 GIF 、 BMP 格式!"),t}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e.imgObj?a("el-card",{staticClass:"card"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h3",[e._v("编辑图片")])]),e._v(" "),a("div",{staticClass:"edit"},[e._l(e.imgObj,function(t,s){return a("div",{key:s,staticClass:"edit-container"},[t.type==e.type?a("div",[a("h4",[e._v(e._s(t.name)+"：")]),e._v(" "),a("div",{staticClass:"img-container"},[a("img",{attrs:{src:t.url,alt:""}})]),e._v(" "),a("el-upload",{staticClass:"upload",attrs:{action:e.uploadApi,headers:e.headerObj,"show-file-list":e.showFile,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadError}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.onUploadClick(t.index)}}},[e._v("点击上传")])],1),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("* 图片建议尺寸为 "+e._s(t.size[0])+"*"+e._s(t.size[1])+"px，格式为*.jpg\\ *.bmp\\ *.png\\ *.gif")])],1):e._e()])}),e._v(" "),3==e.type?a("div",{staticClass:"edit-container"},[a("h4",[e._v("日期背景：")]),e._v(" "),a("div",{staticClass:"img-container"},[a("el-color-picker",{attrs:{"show-alpha":""},model:{value:e.color.background,callback:function(t){e.$set(e.color,"background",t)},expression:"color.background"}})],1)]):e._e()],2)]):e._e()],1)},staticRenderFns:[]};var I=a("VU/8")(S,$,!1,function(e){a("qEZk")},"data-v-58f65483",null).exports,N={props:["code","id"],components:{menuConf:i,phoneModule:n,activityInfo:c.a,activityImageEditor:m.a,shareConf:d.a,signConf:C,dialogModule:F,activityImgPage1:I},data(){return{menuArr:["首页","活动说明页","我的奖品页面","中奖页面","未中奖页面","签到成功弹窗","分享","活动设置"],nowMonth:`${(new Date).getFullYear()}.${(new Date).getMonth()+1}`,weekArr:["日","一","二","三","四","五","六"],page:1,days:null,dayArr:[],signDayArr:[1,2,4,5,6,7,10,20],conf:{description:"",title:"",imgObj:{},share:{shareTitle:"",shareDesc:""},actCode:"",activeStyle:{background:"rgba(240,203,40,1)",color:"#fff"}},dialogVisible:!1,imgType:1,editData:[],selectedGoodsArr:[],data:{},sactBset:{taskCode:this.code,actName:"",signNote:"",share:null,score:null,growth:null,drawChanceFlg:null,continuSignFlg:null,initBtImage:"http://qoss.qrmkt.cn/common/qd/center-sign-btn.png",pressBtImage:"http://qoss.qrmkt.cn/common/qd/center-signEnd-btn.png",drawSignDay:null,pageInfo:""},contItems:[{continuSignDay:null,extraScore:null,extraGrowth:null}],isShow:!1}},watch:{},created(){this.handleDayNum(),this.days=new Date(this.nowMonth+".1").getDay(),this.getPutDetail()},methods:{getPutDetail(){this.$request.post("/sc/saotx/act/bsDetail",{id:this.id},!0,e=>{"200000"===e.ret&&(this.data=e.data,this.data.contItems||(this.data.contItems=[],this.data.contItems.push({continuSignDay:0,extraScore:0,extraGrowth:0})),this.data.sactBset||this.$set(this.data,"sactBset",JSON.parse(JSON.stringify(this.sactBset))),e.data.sactBset.pageInfo?this.conf=JSON.parse(e.data.sactBset.pageInfo):this.conf.imgObj=JSON.parse(JSON.stringify(u.a.img.ACT_SIGN)),this.editData.push(this.conf.imgObj.page7.icon),this.isShow=!0)})},editPic(e){let t=e.index||"",a=e.url;this.page<=6?this.conf.imgObj["page"+this.page][t].url=a:7==this.page&&(this.conf.imgObj.page7.icon.url=a)},getPrize(){this.dialogVisible=!0},updataPage(e){this.page=e},a(){this.signDayArr.push(21)},getSelectedGoodsArr(e){this.selectedGoodsArr=e,this.dialogVisible=!1;let t=[];this.data.gameItems&&this.data.gameItems.length>0&&this.data.gameItems.forEach(e=>{t.push(e.id)}),this.selectedGoodsArr.map(e=>{if(-1!=t.indexOf(e.id))return this.$message.warning("请不要选择重复的奖品");this.data.gameItems||this.$set(this.data,"gameItems",[]),this.data.gameItems.push({orgId:e.orgId,gameId:this.code,gameName:"",productId:e.productId,productName:e.productName,image:e.image,status:e.status,probability:0,type:e.giftType,score:e.score,bingo_image:e.image,shopQuantity:e.shopQuantity,quantity:null,allquantity:0})})},close(){this.dialogVisible=!1},handleDayNum(){let e=(new Date).getMonth()+1,t=(new Date).getFullYear(),a=0;switch(e){case 2:a=t%4!=0||t%100==0&&t%400!=0||t%3200==0?28:29;break;case 1:case 3:case 5:case 7:case 8:case 10:case 12:a=31;break;case 4:case 6:case 9:case 11:a=30}this.forDay(a)},changeImg(e){this.imgType=e},forDay(e){this.dayArr=[];for(let t=1;t<=e;t++)this.dayArr.push(t)},titleInput(e){let t=e.value;this.conf.title=t||""},descInput(e){let t=e.value;t?this.conf.description=t:this.description=""},save(){if(""==this.conf.description||""==this.conf.title)return this.$message.error("首页/模板名称或描述不能为空!");if(this.isRepeat(this.data.contItems,"continuSignDay"))return this.$message.error("连续签到天数不能重复!");let e=JSON.stringify(this.conf);this.data.sactBset.pageInfo=e,this.$request.post("/sc/saotx/act/saveBSet",this.data,!0,e=>{"200000"===e.ret&&(this.$message.success("保存成功"),setTimeout(()=>{this.$router.push("/setting/sign")},1e3))})},isRepeat(e,t){let a=[],s=!1;return e.forEach((e,r)=>{-1==a.indexOf(e[t])?a.push(e[t]):s=!0}),s}}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("menu-conf",{attrs:{menuArr:e.menuArr,page:e.page},on:{updataPage:e.updataPage}}),e._v(" "),a("el-card",{attrs:{"body-style":{padding:"40px"}}},[a("el-row",[a("el-col",{attrs:{span:8}},[e.isShow?a("phone-module",{attrs:{conf:e.conf,page:e.page},on:{changeImg:e.changeImg}}):e._e()],1),e._v(" "),a("el-col",{staticClass:"ml20",attrs:{span:15}},[e.page<7?a("div",[1==e.page&&e.isShow?a("activity-info",{attrs:{title:e.conf.title,desc:e.conf.description},on:{titleInput:e.titleInput,descInput:e.descInput}}):e._e(),e._v(" "),e.page>3&&e.isShow?a("activity-image-editor",{attrs:{editData:e.conf.imgObj["page"+e.page],type:"normal",itemRepeat:!1},on:{picChange:e.editPic}}):e._e(),e._v(" "),1==e.page&&e.isShow?a("activity-img-page1",{attrs:{imgObj:e.conf.imgObj.page1,color:e.conf.activeStyle,type:e.imgType},on:{picChange:e.editPic}}):e._e()],1):e._e(),e._v(" "),7==e.page?a("div",[e.editData?a("share-conf",{attrs:{shareConf:e.conf.share,editData:e.editData},on:{shareChange:e.editPic}}):e._e()],1):e._e(),e._v(" "),8==e.page?a("div",[e.data.sactBset?a("sign-conf",{attrs:{conf:e.data},on:{getPrize:e.getPrize}}):e._e()],1):e._e()])],1),e._v(" "),a("div",{staticClass:"btn mt20"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])],1)],1),e._v(" "),a("el-dialog",{attrs:{width:"800px","close-on-click-modal":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("dialog-module",{on:{getSelectedGoodsArr:e.getSelectedGoodsArr,close:e.close}})],1)],1)},staticRenderFns:[]};var D=a("VU/8")(N,z,!1,function(e){a("bX27")},"data-v-0d512094",null);t.default=D.exports},qEZk:function(e,t){},qSFF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:()=>({actList:[]}),created(){this.getTaskList()},methods:{getTaskList(){this.$request.post("/sc/saotx/act/findList",{},!0,e=>{if("200000"===e.ret)return this.actList=e.data})},goToDetail(e){this.$router.push(`/setting/sign/detail?code=${e.taskCode}&id=${e.id}`)},openOrClose(e,t){e?this.switchAPI(e,t):this.$confirm("是否关闭签到活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.switchAPI(e,t)}).catch(()=>{this.getTaskList(),this.$message({type:"info",message:"已取消关闭"})})},switchAPI(e,t){this.$request.post("/sc/saotx/act/update",{id:t,status:e},!0,t=>{"200000"===t.ret?this.$message.success(e?"开启成功":"关闭成功"):this.$message.error(t.msg)})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-card",e._l(e.actList,function(t,s){return a("div",{key:s,staticClass:"sign"},[a("div",{staticClass:"img",style:{background:"url("+t.taskImg+") no-repeat center / 100% 100%"},on:{click:function(a){e.goToDetail(t)}}}),e._v(" "),a("div",{staticClass:"con"},[a("div",{staticClass:"text"},[a("div",{staticClass:"title"},[e._v(e._s(t.taskName))]),e._v(" "),a("div",{staticClass:"switch"},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){e.openOrClose(t.status,t.id)}},model:{value:t.status,callback:function(a){e.$set(t,"status",a)},expression:"item.status"}})],1)]),e._v(" "),a("div",{staticClass:"desc"},[e._v(e._s(t.taskDetail))])])])}))],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("MILx")},"data-v-83adc0ce",null);t.default=i.exports},tmDH:function(e,t){},v60n:function(e,t){},xs42:function(e,t){},yxOa:function(e,t){}});
//# sourceMappingURL=7.754f380393ea149e6f8b.js.map